title: ã€æ­»ç£• Java å¹¶å‘ã€‘â€”â€“ Java å†…å­˜æ¨¡å‹ä¹‹æ€»ç»“
date: 2018-05-24
tag: 
categories: JUC
permalink: JUC/sike/jmm-4-summary
author: å°æ˜å“¥
from_url: http://cmsblogs.com/?p=2167
wechat_url: https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247483827&idx=1&sn=f2ab39fd8f13b7827553ae9e06dfecd1&chksm=fa497e02cd3ef714a5a5c9530576ee25ef24a159fda006ae38e1d349271d11573b1ad7644a79#rd

-------

æ‘˜è¦: åŸåˆ›å‡ºå¤„ http://cmsblogs.com/?p=2167 ã€Œå°æ˜å“¥ã€æ¬¢è¿è½¬è½½ï¼Œä¿ç•™æ‘˜è¦ï¼Œè°¢è°¢ï¼

ä½œä¸ºã€Œå°æ˜å“¥ã€çš„å¿ å®è¯»è€…ï¼Œã€Œè€è‰¿è‰¿ã€ç•¥ä½œä¿®æ”¹ï¼Œè®°å½•åœ¨ç†è§£è¿‡ç¨‹ä¸­ï¼Œå‚è€ƒçš„èµ„æ–™ã€‚

- [1. æ€»ç»“](http://www.iocoder.cn/JUC/sike/jmm-4-summary/)
- [2. åšæ–‡åˆ—è¡¨](http://www.iocoder.cn/JUC/sike/jmm-4-summary/)
- [3. Javaå†…å­˜æ¨¡å‹æ¨èèµ„æ–™](http://www.iocoder.cn/JUC/sike/jmm-4-summary/)
- [666. å½©è›‹](http://www.iocoder.cn/JUC/sike/jmm-4-summary/)

-------

![](http://www.iocoder.cn/images/common/wechat_mp_2017_07_31.jpg)

> ğŸ™‚ğŸ™‚ğŸ™‚å…³æ³¨**å¾®ä¿¡å…¬ä¼—å·ï¼šã€èŠ‹é“æºç ã€‘**æœ‰ç¦åˆ©ï¼š  
> 1. RocketMQ / MyCAT / Sharding-JDBC **æ‰€æœ‰**æºç åˆ†ææ–‡ç« åˆ—è¡¨  
> 2. RocketMQ / MyCAT / Sharding-JDBC **ä¸­æ–‡æ³¨é‡Šæºç  GitHub åœ°å€**  
> 3. æ‚¨å¯¹äºæºç çš„ç–‘é—®æ¯æ¡ç•™è¨€**éƒ½**å°†å¾—åˆ°**è®¤çœŸ**å›å¤ã€‚**ç”šè‡³ä¸çŸ¥é“å¦‚ä½•è¯»æºç ä¹Ÿå¯ä»¥è¯·æ•™å™¢**ã€‚  
> 4. **æ–°çš„**æºç è§£ææ–‡ç« **å®æ—¶**æ”¶åˆ°é€šçŸ¥ã€‚**æ¯å‘¨æ›´æ–°ä¸€ç¯‡å·¦å³**ã€‚  
> 5. **è®¤çœŸçš„**æºç äº¤æµå¾®ä¿¡ç¾¤ã€‚

-------

ç»è¿‡å››ç¯‡åšå®¢é˜è¿°ï¼Œæˆ‘ç›¸ä¿¡å„ä½å¯¹ Java å†…å­˜æ¨¡å‹æœ‰äº†æœ€åŸºæœ¬è®¤è¯†äº†ï¼Œä¸‹é¢ LZ å°±åšä¸€ä¸ªæ¯”è¾ƒç®€å•çš„æ€»ç»“ã€‚

# 1. æ€»ç»“

> è€è‰¿è‰¿ï¼šæ­¤å¤„çš„æ€»ç»“ï¼Œå†…å®¹ä¸Šä¸æ˜¯å®Œå…¨çº¿æ€§çš„ï¼Œè€Œæ˜¯ä¸€äº›æ¦‚å¿µã€åŸç†ç­‰ç­‰å…³é”®ç‚¹ã€‚

JMM è§„å®šäº†çº¿ç¨‹çš„å·¥ä½œå†…å­˜å’Œä¸»å†…å­˜çš„äº¤äº’å…³ç³»ï¼Œä»¥åŠçº¿ç¨‹ä¹‹é—´çš„å¯è§æ€§å’Œç¨‹åºçš„æ‰§è¡Œé¡ºåºã€‚

* ä¸€æ–¹é¢ï¼Œè¦ä¸ºç¨‹åºå‘˜æä¾›è¶³å¤Ÿå¼ºçš„å†…å­˜å¯è§æ€§ä¿è¯ã€‚
* å¦ä¸€æ–¹é¢ï¼Œå¯¹ç¼–è¯‘å™¨å’Œå¤„ç†å™¨çš„é™åˆ¶è¦å°½å¯èƒ½åœ°æ”¾æ¾ã€‚JMM å¯¹ç¨‹åºå‘˜å±è”½äº† CPU ä»¥åŠ OS å†…å­˜çš„ä½¿ç”¨é—®é¢˜ï¼Œèƒ½å¤Ÿä½¿ç¨‹åºåœ¨ä¸åŒçš„ CPU å’Œ OS å†…å­˜ä¸Šéƒ½èƒ½å¤Ÿè¾¾åˆ°é¢„æœŸçš„æ•ˆæœã€‚

Java é‡‡ç”¨**å†…å­˜å…±äº«çš„**æ¨¡å¼æ¥å®ç°çº¿ç¨‹ä¹‹é—´çš„é€šä¿¡ã€‚ç¼–è¯‘å™¨å’Œå¤„ç†å™¨å¯ä»¥å¯¹ç¨‹åºè¿›è¡Œé‡æ’åºä¼˜åŒ–å¤„ç†ï¼Œä½†æ˜¯éœ€è¦éµå®ˆä¸€äº›è§„åˆ™ï¼Œä¸èƒ½éšæ„é‡æ’åºã€‚

åœ¨å¹¶å‘ç¼–ç¨‹æ¨¡å¼ä¸­ï¼ŒåŠ¿å¿…ä¼šé‡åˆ°ä¸Šé¢ä¸‰ä¸ªæ¦‚å¿µï¼š

* **åŸå­æ€§**ï¼šä¸€ä¸ªæ“ä½œæˆ–è€…å¤šä¸ªæ“ä½œè¦ä¹ˆå…¨éƒ¨æ‰§è¡Œè¦ä¹ˆå…¨éƒ¨ä¸æ‰§è¡Œã€‚
* **å¯è§æ€§**ï¼šå½“å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®ä¸€ä¸ªå…±äº«å˜é‡æ—¶ï¼Œå¦‚æœå…¶ä¸­æŸä¸ªçº¿ç¨‹æ›´æ”¹äº†è¯¥å…±äº«å˜é‡ï¼Œå…¶ä»–çº¿ç¨‹åº”è¯¥å¯ä»¥ç«‹åˆ»çœ‹åˆ°è¿™ä¸ªæ”¹å˜ã€‚
* **æœ‰åºæ€§**ï¼šç¨‹åºçš„æ‰§è¡Œè¦æŒ‰ç…§ä»£ç çš„å…ˆåé¡ºåºæ‰§è¡Œã€‚

JMM å¯¹åŸå­æ€§å¹¶æ²¡æœ‰æä¾›ç¡®åˆ‡çš„è§£å†³æ–¹æ¡ˆï¼Œä½†æ˜¯ JMM è§£å†³äº†å¯è§æ€§å’Œæœ‰åºæ€§ï¼Œè‡³äºåŸå­æ€§åˆ™éœ€è¦é€šè¿‡é”æˆ–è€… `synchronized` æ¥è§£å†³äº†ã€‚

å¦‚æœä¸€ä¸ªæ“ä½œ A çš„æ“ä½œç»“æœéœ€è¦å¯¹æ“ä½œ B å¯è§ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è®¤ä¸ºæ“ä½œ A å’Œæ“ä½œ B ä¹‹é—´å­˜åœ¨**happens-before** å…³ç³»ï¼Œå³ A happens-before B ã€‚

**happens-before åŸåˆ™**ï¼Œæ˜¯ JMM ä¸­éå¸¸é‡è¦çš„ä¸€ä¸ªåŸåˆ™ï¼Œå®ƒæ˜¯åˆ¤æ–­æ•°æ®æ˜¯å¦å­˜åœ¨ç«äº‰ã€çº¿ç¨‹æ˜¯å¦å®‰å…¨çš„ä¸»è¦ä¾æ®ï¼Œä¾é è¿™ä¸ªåŸåˆ™ï¼Œæˆ‘ä»¬å¯ä»¥è§£å†³åœ¨å¹¶å‘ç¯å¢ƒä¸‹ä¸¤ä¸ªæ“ä½œä¹‹é—´æ˜¯å¦å­˜åœ¨å†²çªçš„æ‰€æœ‰é—®é¢˜ã€‚JMM è§„å®šï¼Œä¸¤ä¸ªæ“ä½œå­˜åœ¨ happens-before å…³ç³»å¹¶ä¸ä¸€å®šè¦ A æ“ä½œå…ˆäºB æ“ä½œæ‰§è¡Œï¼Œåªè¦ A æ“ä½œçš„ç»“æœå¯¹ B æ“ä½œå¯è§å³å¯ã€‚

åœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ï¼Œä¸ºäº†æ‰§è¡Œçš„æ•ˆç‡ï¼Œç¼–è¯‘å™¨å’Œå¤„ç†å™¨æ˜¯å¯ä»¥å¯¹ç¨‹åºè¿›è¡Œä¸€å®šçš„é‡æ’åºï¼Œä½†æ˜¯ä»–ä»¬å¿…é¡»è¦æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶ï¼š

1. æ‰§è¡Œçš„ç»“æœä¿æŒä¸å˜
2. å­˜åœ¨æ•°æ®ä¾èµ–çš„ä¸èƒ½é‡æ’åºã€‚é‡æ’åºæ˜¯å¼•èµ·å¤šçº¿ç¨‹ä¸å®‰å…¨çš„ä¸€ä¸ªé‡è¦å› ç´ ã€‚

åŒæ—¶ï¼Œ**é¡ºåºä¸€è‡´æ€§**æ˜¯ä¸€ä¸ªæ¯”è¾ƒç†æƒ³åŒ–çš„å‚è€ƒæ¨¡å‹ï¼Œå®ƒä¸ºæˆ‘ä»¬æä¾›äº†å¼ºå¤§è€Œåˆæœ‰åŠ›çš„å†…å­˜å¯è§æ€§ä¿è¯ï¼Œä»–ä¸»è¦æœ‰ä¸¤ä¸ªç‰¹å¾ï¼š

1. ä¸€ä¸ªçº¿ç¨‹ä¸­çš„æ‰€æœ‰æ“ä½œå¿…é¡»æŒ‰ç…§ç¨‹åºçš„é¡ºåºæ¥æ‰§è¡Œã€‚
2. æ‰€æœ‰çº¿ç¨‹éƒ½åªèƒ½çœ‹åˆ°ä¸€ä¸ªå•ä¸€çš„æ“ä½œæ‰§è¡Œé¡ºåºï¼Œåœ¨é¡ºåºä¸€è‡´æ€§æ¨¡å‹ä¸­ï¼Œæ¯ä¸ªæ“ä½œéƒ½å¿…é¡»åŸåˆ™æ‰§è¡Œä¸”ç«‹åˆ»å¯¹æ‰€æœ‰çº¿ç¨‹å¯è§ã€‚

# 2. åšæ–‡åˆ—è¡¨

1. [ã€Šã€æ­»ç£• Java å¹¶å‘ã€‘â€”â€“ Java å†…å­˜æ¨¡å‹ä¹‹ happens-beforeã€‹](http://www.iocoder.cn/JUC/sike/happens-before)
2. [ã€Šã€æ­»ç£• Java å¹¶å‘ã€‘â€”â€“ Java å†…å­˜æ¨¡å‹ä¹‹é‡æ’åºã€‹](http://www.iocoder.cn/JUC/sike/jmm-1)
3. [ã€Šã€æ­»ç£• Java å¹¶å‘ã€‘â€”â€“ Java å†…å­˜æ¨¡å‹ä¹‹åˆ†æ volatileã€‹](http://www.iocoder.cn/JUC/sike/jmm-2-volatile)
4. [ã€Šã€æ­»ç£• Java å¹¶å‘ã€‘â€”â€“ Java å†…å­˜æ¨¡å‹ä¹‹ä» JMM è§’åº¦åˆ†æ DCLã€‹](http://www.iocoder.cn/JUC/sike/jmm-3-dcl)

# 3. Javaå†…å­˜æ¨¡å‹æ¨èèµ„æ–™

1. ç¨‹æ™“æ˜ï¼š[ã€Šæ·±å…¥Javaå†…å­˜æ¨¡å‹ã€‹](http://files.cnblogs.com/files/skywang12345/%E6%B7%B1%E5%85%A5Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B.pdf)
    
    > è€è‰¿è‰¿ï¼šè‡ªå·±å’Œè›®å¤šæœ‹å‹éƒ½çœ‹è¿‡ï¼Œå¿…è¯»ï¼ï¼ï¼å¦å¤–ï¼Œè¿™æœ¬å°ä¹¦ä¹Ÿè¢«æ•´ç†åˆ°äº† [ã€ŠJava å¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯ã€‹](#) çš„ [ã€Œ3. Java å†…å­˜æ¨¡å‹ã€](#) ç« èŠ‚ã€‚

2. å‘¨å¿—æ˜ï¼š[ã€Šæ·±å…¥ç†è§£ Java è™šæ‹Ÿæœºã€‹](https://item.jd.com/11252778.html) çš„ [ã€Œç¬¬äº”éƒ¨åˆ† é«˜æ•ˆå¹¶å‘ã€](#)
3. [ã€ŠJava å¹¶å‘ç¼–ç¨‹ï¼švolatile çš„ä½¿ç”¨åŠå…¶åŸç†ã€‹](http://www.cnblogs.com/paddix/p/5428507.html)
4. [ã€ŠJavaå¹¶å‘ç¼–ç¨‹ï¼švolatile å…³é”®å­—è§£æã€‹](http://www.cnblogs.com/dolphin0520/p/3920373.html)
5. [ã€ŠèŠèŠé«˜å¹¶å‘ï¼ˆä¸‰åä¸‰ï¼‰Java å†…å­˜æ¨¡å‹é‚£äº›äº‹ï¼ˆä¸€ï¼‰ä»ä¸€è‡´æ€§(Consistency)çš„è§’åº¦ç†è§£Javaå†…å­˜æ¨¡å‹ã€‹](http://blog.csdn.net/iter_zc/article/details/41943387)
6. [ã€ŠèŠèŠé«˜å¹¶å‘ï¼ˆä¸‰åå››ï¼‰Java å†…å­˜æ¨¡å‹é‚£äº›äº‹ï¼ˆäºŒï¼‰ç†è§£ CPU é«˜é€Ÿç¼“å­˜çš„å·¥ä½œåŸç†ã€‹](http://blog.csdn.net/iter_zc/article/details/41979189)
7. [ã€ŠèŠèŠé«˜å¹¶å‘ï¼ˆä¸‰åäº”ï¼‰Java å†…å­˜æ¨¡å‹é‚£äº›äº‹ï¼ˆä¸‰ï¼‰ç†è§£å†…å­˜å±éšœã€‹](http://blog.csdn.net/iter_zc/article/details/42006811)
8. [ã€ŠèŠèŠé«˜å¹¶å‘ï¼ˆä¸‰åå…­ï¼‰Java å†…å­˜æ¨¡å‹é‚£äº›äº‹ï¼ˆå››ï¼‰ç†è§£ happens-before è§„åˆ™ã€‹](http://blog.csdn.net/iter_zc/article/details/42026511)
9. [ã€Šhappens-before ä¿—è§£ã€‹](http://ifeve.com/easy-happens-before/)

# 666. å½©è›‹

å¦‚æœä½ å¯¹ Java å¹¶å‘æ„Ÿå…´è¶£ï¼Œæ¬¢è¿åŠ å…¥æˆ‘çš„çŸ¥è¯†æ˜Ÿçƒä¸€èµ·äº¤æµã€‚

![çŸ¥è¯†æ˜Ÿçƒ](http://www.iocoder.cn/images/Architecture/2017_12_29/01.png)

