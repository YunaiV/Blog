title: ã€è®¾è®¡æ¨¡å¼è¯»ä¹¦ç¬”è®°ã€‘å‘½ä»¤æ¨¡å¼
date: 2018-01-16
tags:
categories: è®¾è®¡æ¨¡å¼
permalink: DesignPattern/xiaomingge/Command-Pattern
author: å°æ˜å“¥
from_url: http://www.cnblogs.com/chenssy/p/3202107.html
wechat_url:

-------

æ‘˜è¦: åŸåˆ›å‡ºå¤„  ã€Œå°æ˜å“¥ã€æ¬¢è¿è½¬è½½ï¼Œä¿ç•™æ‘˜è¦ï¼Œè°¢è°¢ï¼

- [ä¸€ã€åŸºæœ¬å®šä¹‰](http://www.iocoder.cn/DesignPattern/xiaomingge/Command-Pattern/)
- [äºŒã€æ¨¡å¼ç»“æ„](http://www.iocoder.cn/DesignPattern/xiaomingge/Command-Pattern/)
- [ä¸‰ã€æ¨¡å¼å®ç°](http://www.iocoder.cn/DesignPattern/xiaomingge/Command-Pattern/)
- [å››ã€æ¨¡å¼ä¼˜ç¼ºç‚¹](http://www.iocoder.cn/DesignPattern/xiaomingge/Command-Pattern/)
  - [ä¼˜ç‚¹](http://www.iocoder.cn/DesignPattern/xiaomingge/Command-Pattern/)
  - [ç¼ºç‚¹](http://www.iocoder.cn/DesignPattern/xiaomingge/Command-Pattern/)
- [äº”ã€æ¨¡å¼ä½¿ç”¨åœºæ™¯](http://www.iocoder.cn/DesignPattern/xiaomingge/Command-Pattern/)
- [å…­ã€æ¨¡å¼æ‰©å±•](http://www.iocoder.cn/DesignPattern/xiaomingge/Command-Pattern/)
- [ä¸ƒã€æ€»ç»“](http://www.iocoder.cn/DesignPattern/xiaomingge/Command-Pattern/)

-------

![](http://www.iocoder.cn/images/common/wechat_mp_2017_07_31.jpg)

> ğŸ™‚ğŸ™‚ğŸ™‚å…³æ³¨**å¾®ä¿¡å…¬ä¼—å·ï¼šã€èŠ‹é“æºç ã€‘**æœ‰ç¦åˆ©ï¼š
> 1. RocketMQ / MyCAT / Sharding-JDBC **æ‰€æœ‰**æºç åˆ†ææ–‡ç« åˆ—è¡¨
> 2. RocketMQ / MyCAT / Sharding-JDBC **ä¸­æ–‡æ³¨é‡Šæºç  GitHub åœ°å€**
> 3. æ‚¨å¯¹äºæºç çš„ç–‘é—®æ¯æ¡ç•™è¨€**éƒ½**å°†å¾—åˆ°**è®¤çœŸ**å›å¤ã€‚**ç”šè‡³ä¸çŸ¥é“å¦‚ä½•è¯»æºç ä¹Ÿå¯ä»¥è¯·æ•™å™¢**ã€‚
> 4. **æ–°çš„**æºç è§£ææ–‡ç« **å®æ—¶**æ”¶åˆ°é€šçŸ¥ã€‚**æ¯å‘¨æ›´æ–°ä¸€ç¯‡å·¦å³**ã€‚
> 5. **è®¤çœŸçš„**æºç äº¤æµå¾®ä¿¡ç¾¤ã€‚

-------

åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæˆ‘å¯èƒ½ä¼šéœ€è¦å‘æŸäº›å¯¹è±¡å‘é€ä¸€äº›è¯·æ±‚ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸çŸ¥è¯·æ±‚çš„å…·ä½“æ¥æ”¶è€…æ˜¯è°ï¼Œä¹Ÿä¸çŸ¥é“è¢«è¯·æ±‚çš„æ“ä½œæ˜¯é‚£ä¸ªï¼Œæˆ‘ä»¬åªçŸ¥é“åœ¨ç¨‹åºè¿è¡Œä¸­æŒ‡å®šå…·ä½“çš„è¯·æ±‚æ¥æ”¶è€…å³å¯ã€‚æ‰“ä¸ªæ¯”æ–¹ï¼Œç”µè§†é¥æ§å™¨ï¼Œæˆ‘ä»¬åªéœ€è¦çŸ¥é“æŒ‰é‚£ä¸ªæŒ‰é’®èƒ½å¤Ÿæ‰“å¼€ç”µè§†ã€å…³é—­ç”µè§†å’Œæ¢å°å³å¯ï¼Œå¹¶ä¸éœ€è¦çŸ¥é“æ˜¯æ€ä¹ˆå¼€ç”µè§†ã€å…³ç”µè§†å’Œæ¢å°çš„ã€‚å¯¹äºè¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨å‘½ä»¤æ¨¡å¼æ¥è¿›è¡Œè®¾è®¡ã€‚

# ä¸€ã€åŸºæœ¬å®šä¹‰

å‘½ä»¤æ¨¡å¼å°†è¯·æ±‚å°è£…æˆå¯¹è±¡ï¼Œä»¥ä¾¿ä½¿ç”¨ä¸åŒçš„è¯·æ±‚ã€é˜Ÿåˆ—æˆ–è€…æ—¥å¿—æ¥å‚æ•°åŒ–å…¶ä»–å¯¹è±¡ã€‚å‘½ä»¤æ¨¡å¼æ”¯æŒå¯æ’¤é”€çš„æ“ä½œã€‚

å‘½ä»¤æ¨¡å¼å¯ä»¥å¯¹å‘é€è€…é¢æ¥å—è€…å®Œå…¨è§£è€¦ï¼Œå‘é€è€…ä¹Ÿæ¥æ”¶è€…ä¹‹é—´å¹¶æ²¡æœ‰ç›´æ¥çš„è”ç³»ï¼Œå‘é€è€…åªéœ€è¦çŸ¥é“å¦‚ä½•å‘é€è¯·æ±‚ï¼Œä¸éœ€è¦å…³å¿ƒè¯·æ±‚æ˜¯å¦‚ä½•å®Œæˆäº†ã€‚è¿™å°±æ˜¯å‘½ä»¤æ¨¡å¼ï¼Œå‘½ä»¤æ¨¡å¼å°†æ–¹æ³•è°ƒç”¨ç»™å°è£…èµ·æ¥äº†ã€‚

 

# äºŒã€æ¨¡å¼ç»“æ„

![img](http://static.iocoder.cn/cnblogs/blog/381060/201307/20104844-aa34697c84464e6290a8fb3d05720f77.jpg)

ä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºå‘½ä»¤æ¨¡å¼åŒ…å«å¦‚ä¸‹å‡ ä¸ªè§’è‰²ï¼š

   Command: æŠ½è±¡å‘½ä»¤ç±»

   ConcreteCommand: å…·ä½“å‘½ä»¤ç±»

   Invoker: è°ƒç”¨è€…

   Receiver: æ¥æ”¶è€…

   Client:å®¢æˆ·ç±»

å‘½ä»¤æ¨¡å¼çš„æœ¬è´¨å°±åœ¨äºå°†å‘½ä»¤è¿›è¡Œå°è£…ï¼Œå°†å‘å‡ºå‘½ä»¤çš„è´£ä»»å’Œæ‰§è¡Œå‘½ä»¤çš„è´£ä»»åˆ†å¼€ï¼Œæ˜¯çš„å‘é€è€…åªéœ€è¦çŸ¥é“å¦‚ä½•å‘é€å‘½ä»¤å³å¯ï¼Œä¸éœ€è¦å‘½ä»¤æ˜¯å¦‚ä½•å®ç°çš„ï¼Œç”šè‡³å‘½ä»¤æ‰§è¡Œæ˜¯å¦æˆåŠŸéƒ½ä¸éœ€è¦ç†ä¼šã€‚åŒæ—¶å‘½ä»¤æ¨¡å¼ä½¿å¾—è¯·æ±‚ä¹Ÿå˜æˆäº†ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒåƒå…¶ä»–å¯¹è±¡ä¸€æ ·å¯ä»¥è¢«å­˜å‚¨å’Œä¼ é€’ã€‚

 

# ä¸‰ã€æ¨¡å¼å®ç°

è¿™é‡Œä»¥ç”µè§†æœºä¸ºä¾‹ã€‚ç”µè§†å‰§æ˜¯è¯·æ±‚çš„æ¥å—è€…ï¼Œé¥æ§å™¨æ˜¯è¯·æ±‚çš„å‘é€è€…ï¼Œé¥æ§å™¨ä¸Šæœ‰ä¸€äº›æŒ‰é’®ï¼Œä¸åŒçš„æŒ‰é’®å¯¹åº”ç€ä¸åŒçš„æ“ä½œã€‚åœ¨è¿™é‡Œé¥æ§å™¨éœ€è¦æ‰§è¡Œä¸‰ä¸ªå‘½ä»¤ï¼šæ‰“å¼€ç”µè§†æœºã€å…³é—­ç”µè§†æœºã€æ¢å°ã€‚

UMLå›¾ï¼š

![img](http://static.iocoder.cn/cnblogs/blog/381060/201307/20104900-8b2beb57fc7644b3a282aea7eeee4823.jpg)

ä»£ç çš„å®ç°

æŠ½è±¡å‘½ä»¤ç±»ï¼šCommand.java



```Java
1 /**
2  * Commandå‘½ä»¤æ¥å£ï¼Œä¸ºæ‰€æœ‰çš„å‘½ä»¤å£°æ˜ä¸€ä¸ªæ¥å£ã€‚æ‰€æœ‰çš„å‘½ä»¤éƒ½åº”è¯¥å®ç°å®ƒ
3  */
4 public interface Command {
5     public void execute();
6 }
```



ç”µè§†æœºç±»ï¼šTelevision.java



```Java
 1 public class Television {
 2     public void open(){
 3         System.out.println("æ‰“å¼€ç”µè§†æœº......");
 4     }
 5     
 6     public void close(){
 7         System.out.println("å…³é—­ç”µè§†æœº......");        
 8     }
 9     
10     public void changeChannel(){
11         
12         System.out.println("åˆ‡æ¢ç”µè§†é¢‘é“......");
13     }
14 }
```



é¥æ§å™¨ç±»ï¼šController.java



```Java
 1 public class Controller {
 2     private Command openTVCommand;
 3     private Command closeTVCommand;
 4     private Command changeChannelCommand;
 5     
 6     public Controller(Command openTvCommand,Command closeTvCommand,Command changeChannelCommand){
 7         this.openTVCommand = openTvCommand;
 8         this.closeTVCommand = closeTvCommand;
 9         this.changeChannelCommand = changeChannelCommand;
10     }
11     
12     /**
13      * æ‰“å¼€ç”µè§†å‰§
14      */
15     public void open(){
16         openTVCommand.execute();
17     }
18     
19     /**
20      * å…³é—­ç”µè§†æœº
21      */
22     public void close(){
23         closeTVCommand.execute();
24     }
25     
26     /**
27      * æ¢é¢‘é“
28      */
29     public void change(){
30         
31         changeChannelCommand.execute();
32     }
33     
34 }
```



é¥æ§å™¨çš„ä¸‰ä¸ªæŒ‰é’®



```Java
 1 public class OpenTvCommand implements Command{
 2     private Television tv;
 3     
 4     public OpenTvCommand(){
 5         tv = new Television();
 6     }
 7     
 8     public void execute() {
 9         tv.open();
10     }
11 
12 }
```



 



```Java
 1 public class ChangeChannelCommand implements Command{
 2     private Television tv;
 3     
 4     public ChangeChannelCommand(){
 5         tv = new Television();
 6     }
 7     
 8     public void execute() {
 9         tv.changeChannel();
10     }
11 
12 }
```





```Java
 1 public class CloseTvCommand implements Command{
 2     private Television tv;
 3     
 4     public CloseTvCommand(){
 5         tv = new Television();
 6     }
 7     
 8     public void execute() {
 9         tv.close();
10     }
11     
12 }
```



å®¢æˆ·ç«¯ï¼šClient.java



```Java
 1 public class Client {
 2         public static void main(String a[])
 3         {
 4             Command openCommand,closeCommand,changeCommand;
 5             
 6             openCommand = new OpenTvCommand();
 7             closeCommand = new CloseTvCommand();
 8             changeCommand = new ChangeChannelCommand();
 9             
10             Controller control = new Controller(openCommand,closeCommand,changeCommand);
11             
12             control.open();           //æ‰“å¼€ç”µè§†æœº
13             control.change();         //æ¢é¢‘é“
14             control.close();          //å…³é—­ç”µè§†æœº
15         }
16 
17 }
```



è¿è¡Œç»“æœ

![img](http://static.iocoder.cn/cnblogs/blog/381060/201307/20105205-7944356f910943e4b8fe78aab76924b8.jpg)

 

# å››ã€æ¨¡å¼ä¼˜ç¼ºç‚¹

## ä¼˜ç‚¹

    1. é™ä½äº†ç³»ç»Ÿè€¦åˆåº¦

    2. æ–°çš„å‘½ä»¤å¯ä»¥å¾ˆå®¹æ˜“æ·»åŠ åˆ°ç³»ç»Ÿä¸­å»ã€‚

## ç¼ºç‚¹

    ä½¿ç”¨å‘½ä»¤æ¨¡å¼å¯èƒ½ä¼šå¯¼è‡´æŸäº›ç³»ç»Ÿæœ‰è¿‡å¤šçš„å…·ä½“å‘½ä»¤ç±»ã€‚

 

# äº”ã€æ¨¡å¼ä½¿ç”¨åœºæ™¯

    1.ç³»ç»Ÿéœ€è¦å°†è¯·æ±‚è°ƒç”¨è€…å’Œè¯·æ±‚æ¥æ”¶è€…è§£è€¦ï¼Œä½¿å¾—è°ƒç”¨è€…å’Œæ¥æ”¶è€…ä¸ç›´æ¥äº¤äº’ã€‚

    2.ç³»ç»Ÿéœ€è¦åœ¨ä¸åŒçš„æ—¶é—´æŒ‡å®šè¯·æ±‚ã€å°†è¯·æ±‚æ’é˜Ÿå’Œæ‰§è¡Œè¯·æ±‚ã€‚

    3.ç³»ç»Ÿéœ€è¦æ”¯æŒå‘½ä»¤çš„æ’¤é”€(Undo)æ“ä½œå’Œæ¢å¤(Redo)æ“ä½œã€‚

    5.ç³»ç»Ÿéœ€è¦å°†ä¸€ç»„æ“ä½œç»„åˆåœ¨ä¸€èµ·ï¼Œå³æ”¯æŒå®å‘½ä»¤ã€‚

 

# å…­ã€æ¨¡å¼æ‰©å±•

    1. æ’¤é”€å‘½ä»¤

    åœ¨ç”µè§†é¥æ§å™¨ä¸­ï¼Œæˆ‘ä»¬è¿˜æœ‰è¿™æ ·ä¸€ä¸ªæŒ‰é’®ï¼Œé‚£å°±æ˜¯è¿”å›ã€‚ç”¨äºåˆ‡æ¢åˆ°ä¸Šé¢ä¸€ä¸ªé¢‘é“ä¸­å»ã€‚åœ¨å‘½ä»¤æ¨¡å¼ä¸­ä¹Ÿæ”¯æŒæ’¤é”€æ“ä½œï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬åªéœ€è¦è®°å½•ä¸Šä¸€ä¸ªé¢‘é“ï¼Œç„¶åå°†ä¸Šä¸€ä¸ªé¢‘é“ä¼ å…¥å³å¯ã€‚

    åœ¨è¿™é‡Œå°†Commandè¿›è¡Œä¸€ä¸ªç®€å•çš„ä¿®æ”¹ï¼šå°†execute()æ”¹ä¸ºexecute(int I );iè¡¨ç¤ºé¢‘é“ï¼Œç”¨äºè¿›è¡Œé¢‘é“åˆ‡æ¢ã€‚



```Java
 1 /**
 2  * Commandå‘½ä»¤æ¥å£ï¼Œä¸ºæ‰€æœ‰çš„å‘½ä»¤å£°æ˜ä¸€ä¸ªæ¥å£ã€‚æ‰€æœ‰çš„å‘½ä»¤éƒ½åº”è¯¥å®ç°å®ƒ
 3  */
 4 public interface Command {
 5     /**
 6      * ä¸ºäº†æ–¹ä¾¿åˆ‡æ¢é¢‘é“ï¼Œè¿™é‡Œä½¿ç”¨å‚æ•°iå°†é¢‘é“ä¼ é€’
 7      * @param i
 8      */
 9     public void execute(int i);
10 }
```



â€‹       ç„¶ååœ¨Controllerä¸­æ·»åŠ channelUndo()æ–¹æ³•ï¼Œç”¨äºè¿›è¡Œé¢‘é“è¿”å›ã€‚å¹¶ä¸”éœ€è¦è¿›è¡Œä¸€äº›ç®€å•çš„ä¿®æ”¹ã€‚



```Java
 1 public class Controller {
 2     private Command openTVCommand;
 3     private Command closeTVCommand;
 4     private Command changeChannelCommand;
 5     
 6     public int nowChannel = 0;       //å½“å‰é¢‘é“
 7     public int priorChannel;     //å‰ä¸€ä¸ªé¢‘é“ï¼Œç”¨äºæ‰§è¡Œè¿”å›æ“ä½œ
 8     
 9     public Controller(Command openTvCommand,Command closeTvCommand,Command changeChannelCommand){
10         this.openTVCommand = openTvCommand;
11         this.closeTVCommand = closeTvCommand;
12         this.changeChannelCommand = changeChannelCommand;
13     }
14     
15     /**
16      * æ‰“å¼€ç”µè§†å‰§
17      */
18     public void open(){
19         openTVCommand.execute(0);
20     }
21     
22     /**
23      * å…³é—­ç”µè§†æœº
24      */
25     public void close(){
26         closeTVCommand.execute(0);
27     }
28     
29     /**
30      * æ¢é¢‘é“ï¼šåªåœ¨å½“å‰é¢‘é“é€’å¢
31      */
32     public void change(){
33         priorChannel = nowChannel;            //æ¢é¢‘é“å‰è®°å½•å½“å‰é¢‘é“
34         nowChannel++;       //é¢‘é“+1
35         changeChannelCommand.execute(nowChannel);
36     }
37     
38     /**
39      * é¢‘é“è¿”å›
40      */
41     public void ChannelUndo(){
42         changeChannelCommand.execute(priorChannel);          //å°†ä»¥å‰çš„é¢‘é“ä¼ å…¥
43         //å½“å‰é¢‘é“ä¸å‰ä¸€ä¸ªé¢‘é“è¿›è¡Œäº’æ¢
44         int tempChannel;
45         tempChannel = priorChannel;
46         priorChannel = nowChannel;
47         nowChannel = tempChannel;
48     }
49 }
```



    å®¢æˆ·ç«¯

 



```Java
 1 public class Client {
 2         public static void main(String a[])
 3         {
 4             Command openCommand,closeCommand,changeCommand;
 5             
 6             openCommand = new OpenTvCommand();
 7             closeCommand = new CloseTvCommand();
 8             changeCommand = new ChangeChannelCommand();
 9             
10             Controller control = new Controller(openCommand,closeCommand,changeCommand);
11             
12             control.open();           //æ‰“å¼€ç”µè§†æœº
13             control.change();         //æ¢é¢‘é“
14             control.change();
15             control.ChannelUndo();
16             control.ChannelUndo();
17             control.ChannelUndo();
18             control.close();          //å…³é—­ç”µè§†æœº
19         }
20 
21 }
```



    è¿è¡Œç»“æœã€‚

![img](http://static.iocoder.cn/cnblogs/blog/381060/201307/20105401-a6873181360444629f73eeb5376ce75f.jpg)

 

# ä¸ƒã€æ€»ç»“

    1. å‘½ä»¤æ¨¡å¼çš„æœ¬è´¨å°±æ˜¯å°†å‘½ä»¤å¯¹è±¡è¿›è¡Œå°è£…æ‰“åŒ…ï¼Œå°†å‘å‡ºå‘½ä»¤çš„è´£ä»»å’Œæ‰§è¡Œå‘½ä»¤çš„è´£ä»»è¿›è¡Œå‰²å¼€ã€‚

    2. å‘½ä»¤æ¨¡å¼ä¸­å‘é€è€…åªéœ€è¦çŸ¥é“å¦‚ä½•å‘é€è¯·æ±‚å‘½ä»¤ï¼Œæ— é¡»å…³å¿ƒå‘½ä»¤æ‰§è¡Œå…·ä½“è¿‡ç¨‹ã€‚

    3. åœ¨å‘é€è€…å’Œæ¥æ”¶è€…ä¸¤è€…é—´æ˜¯é€šè¿‡å‘½ä»¤å¯¹è±¡è¿›è¡Œæ²Ÿé€šçš„ã€‚è¯·æ±‚å‘½ä»¤æœ¬èº«å°±å½“åšä¸€ä¸ªå¯¹è±¡åœ¨ä¸¤è€…é—´è¿›è¡Œä¼ é€’ï¼Œå®ƒå°è£…äº†æ¥æ”¶è€…å’Œä¸€ç»„åŠ¨ä½œã€‚

    4. å‘½ä»¤æ¨¡å¼æ”¯æŒæ’¤é”€ã€‚

    5. å‘½ä»¤æ¨¡å¼é˜Ÿåˆ—è¯·æ±‚å’Œæ—¥å¿—è¯·æ±‚ã€‚

# 666. å½©è›‹

å¦‚æœä½ å¯¹ è®¾è®¡æ¨¡å¼ æ„Ÿå…´è¶£ï¼Œæ¬¢è¿åŠ å…¥æˆ‘çš„çŸ¥è¯†ä¸€èµ·äº¤æµã€‚

![çŸ¥è¯†æ˜Ÿçƒ](http://www.iocoder.cn/images/Architecture/2017_12_29/01.png)