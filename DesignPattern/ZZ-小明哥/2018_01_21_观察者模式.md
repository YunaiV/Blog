title: ã€è®¾è®¡æ¨¡å¼è¯»ä¹¦ç¬”è®°ã€‘è§‚å¯Ÿè€…æ¨¡å¼
date: 2018-01-21
tags:
categories: è®¾è®¡æ¨¡å¼
permalink: DesignPattern/xiaomingge/Observer-Pattern
author: å°æ˜å“¥
from_url: http://www.cnblogs.com/chenssy/archive/2013/05/22/3092071.html
wechat_url:

-------

æ‘˜è¦: åŸåˆ›å‡ºå¤„ http://www.cnblogs.com/chenssy/archive/2013/05/22/3092071.html ã€Œå°æ˜å“¥ã€æ¬¢è¿è½¬è½½ï¼Œä¿ç•™æ‘˜è¦ï¼Œè°¢è°¢ï¼

- [ä¸€ã€åŸºæœ¬å®šä¹‰](http://www.iocoder.cn/DesignPattern/xiaomingge//)
- [äºŒã€åŸºæœ¬ç»“æ„](http://www.iocoder.cn/DesignPattern/xiaomingge//)
- [ä¸‰ã€å®ç°è§‚å¯Ÿè€…æ¨¡å¼](http://www.iocoder.cn/DesignPattern/xiaomingge//)
- [å››ã€è§‚å¯Ÿè€…æ¨¡å¼çš„ä¼˜ç¼ºç‚¹](http://www.iocoder.cn/DesignPattern/xiaomingge//)
  - [ä¼˜ç‚¹ï¼š](http://www.iocoder.cn/DesignPattern/xiaomingge//)
  - [ç¼ºç‚¹ï¼š](http://www.iocoder.cn/DesignPattern/xiaomingge//)
- [äº”ã€è§‚å¯Ÿè€…æ¨¡å¼çš„é€‚ç”¨åœºæ‰€](http://www.iocoder.cn/DesignPattern/xiaomingge//)
- [æ€»ç»“](http://www.iocoder.cn/DesignPattern/xiaomingge//)

-------

![](http://www.iocoder.cn/images/common/wechat_mp_2017_07_31.jpg)

> ğŸ™‚ğŸ™‚ğŸ™‚å…³æ³¨**å¾®ä¿¡å…¬ä¼—å·ï¼šã€èŠ‹é“æºç ã€‘**æœ‰ç¦åˆ©ï¼š
> 1. RocketMQ / MyCAT / Sharding-JDBC **æ‰€æœ‰**æºç åˆ†ææ–‡ç« åˆ—è¡¨
> 2. RocketMQ / MyCAT / Sharding-JDBC **ä¸­æ–‡æ³¨é‡Šæºç  GitHub åœ°å€**
> 3. æ‚¨å¯¹äºæºç çš„ç–‘é—®æ¯æ¡ç•™è¨€**éƒ½**å°†å¾—åˆ°**è®¤çœŸ**å›å¤ã€‚**ç”šè‡³ä¸çŸ¥é“å¦‚ä½•è¯»æºç ä¹Ÿå¯ä»¥è¯·æ•™å™¢**ã€‚
> 4. **æ–°çš„**æºç è§£ææ–‡ç« **å®æ—¶**æ”¶åˆ°é€šçŸ¥ã€‚**æ¯å‘¨æ›´æ–°ä¸€ç¯‡å·¦å³**ã€‚
> 5. **è®¤çœŸçš„**æºç äº¤æµå¾®ä¿¡ç¾¤ã€‚

-------

# ä¸€ã€åŸºæœ¬å®šä¹‰

ä½•è°“è§‚å¯Ÿè€…æ¨¡å¼ï¼Ÿè§‚å¯Ÿè€…æ¨¡å¼å®šä¹‰äº†å¯¹è±¡ä¹‹é—´çš„ä¸€å¯¹å¤šä¾èµ–å…³ç³»ï¼Œè¿™æ ·ä¸€æ¥ï¼Œå½“ä¸€ä¸ªå¯¹è±¡æ”¹å˜çŠ¶æ€æ—¶ï¼Œå®ƒçš„æ‰€æœ‰ä¾èµ–è€…éƒ½ä¼šæ”¶åˆ°é€šçŸ¥å¹¶ä¸”è‡ªåŠ¨æ›´æ–°ã€‚

åœ¨è¿™é‡Œï¼Œå‘ç”Ÿæ”¹å˜çš„å¯¹è±¡ç§°ä¹‹ä¸ºè§‚å¯Ÿç›®æ ‡ï¼Œè€Œè¢«é€šçŸ¥çš„å¯¹è±¡ç§°ä¹‹ä¸ºè§‚å¯Ÿè€…ã€‚ä¸€ä¸ªè§‚å¯Ÿç›®æ ‡å¯ä»¥å¯¹åº”å¤šä¸ªè§‚å¯Ÿè€…ï¼Œè€Œä¸”è¿™äº›è§‚å¯Ÿè€…ä¹‹é—´æ²¡æœ‰ç›¸äº’è”ç³»ï¼Œæ‰€ä»¥ä¹ˆå¯ä»¥æ ¹æ®éœ€è¦å¢åŠ å’Œåˆ é™¤è§‚å¯Ÿè€…ï¼Œä½¿å¾—ç³»ç»Ÿæ›´æ˜“äºæ‰©å±•ã€‚

è§‚å¯Ÿè€…æ¨¡å¼åˆç§°ä¸ºå‘å¸ƒ-è®¢é˜…æ¨¡å¼ã€‚



# äºŒã€åŸºæœ¬ç»“æ„

é¦–å…ˆå…ˆçœ‹è§‚å¯Ÿè€…æ¨¡å¼çš„UMLç±»å›¾ã€‚

![img](http://static.iocoder.cn/csdn/20130521154413273)



åˆ†æï¼š

   Subjectï¼šç›®æ ‡ã€‚ä»–æŠŠæ‰€æœ‰å¯¹è§‚å¯Ÿè€…å¯¹æˆçš„å¼•ç”¨ä¿å­˜åœ¨ä¸€ä¸ªèšé›†é‡Œï¼Œæ¯ä¸€ä¸ªä¸»é¢˜éƒ½å¯ä»¥æœ‰å¤šä¸ªè§‚å¯Ÿè€…ã€‚

   Observerï¼šè§‚å¯Ÿè€…ã€‚ä¸ºæ‰€æœ‰çš„å…·ä½“è§‚å¯Ÿè€…å®šä¹‰ä¸€ä¸ªæ¥å£ï¼Œåœ¨å¾—åˆ°ä¸»é¢˜çš„é€šçŸ¥æ—¶èƒ½å¤ŸåŠæ—¶çš„æ›´æ–°è‡ªå·±ã€‚

   ConcreteSubjectï¼šå…·ä½“ä¸»é¢˜ã€‚å°†æœ‰å…³çŠ¶æ€å­˜å…¥å…·ä½“è§‚å¯Ÿè€…å¯¹è±¡ã€‚åœ¨å…·ä½“ä¸»é¢˜å‘ç”Ÿæ”¹å˜æ—¶ï¼Œç»™æ‰€æœ‰çš„è§‚å¯Ÿè€…å‘å‡ºé€šçŸ¥ã€‚

   ConcreteObserver:å…·ä½“è§‚å¯Ÿè€…ã€‚å®ç°æŠ½è±¡è§‚å¯Ÿè€…è§’è‰²æ‰€è¦æ±‚çš„æ›´æ–°æ¥å£ï¼Œä»¥ä¾¿ä½¿æœ¬èº«çš„çŠ¶æ€ä¸ä¸»é¢˜çŠ¶æ€ç›¸åè°ƒã€‚



# ä¸‰ã€å®ç°è§‚å¯Ÿè€…æ¨¡å¼

æƒ…æ™¯æ˜¯è¿™æ ·çš„ï¼šåœ¨æ°”è±¡è§‚æµ‹ç«™ä¸­ï¼Œå®ƒèƒ½å¤Ÿè¿½è¸ªç›®å‰çš„å¤©æ°”çŠ¶å†µï¼ŒåŒ…æ‹¬æ¸©åº¦ã€é€‚åº¦ã€æ°”å‹ã€‚éœ€è¦å®ç°ä¸€ä¸ªå¸ƒå‘Šæ¿ï¼Œèƒ½å¤Ÿåˆ†åˆ«æ˜¾ç¤ºç›®å‰çš„çŠ¶æ€ï¼Œæ°”è±¡ç»Ÿè®¡å’Œç®€å•çš„é¢„æŠ¥ã€‚å½“æ°”è±¡ç«™ä¸­è·å–æœ€æ–°çš„æµ‹é‡æ•°æ®æ—¶ï¼Œä¸‰ç§å¸ƒå‘Šæ¿å¿…é¡»å®æ—¶æ›´æ–°ã€‚

ä¸‹é¢æ˜¯è¿™ä¸ªæ¡ˆä¾‹çš„è®¾è®¡å›¾ï¼š

![img](http://static.iocoder.cn/csdn/20130521154426757)



ç¼–ç å®ç°ï¼š

ä¸»é¢˜æ¥å£   Subject.java





```Java
 1 public interface Subject {
 2     /**
 3      * æ³¨å†Œè§‚å¯Ÿè€…
 4      * @param observer
 5      */
 6     public void registerObserver(Observer observer);
 7
 8     /**
 9      * åˆ é™¤è§‚å¯Ÿè€…
10      * @param observer
11      */
12     public void removeOberver(Observer observer);
13
14     /**
15      * å½“ä¸»é¢˜çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œè¿™ä¸ªæ–¹æ³•éœ€è¦è¢«è°ƒç”¨ï¼Œä»¥é€šçŸ¥æ‰€æœ‰è§‚å¯Ÿè€…
16      */
17     public void notifyObserver();
18 }
```



è§‚å¯Ÿè€…æ¥å£  Observer.java

```Java
1 public interface Observer {
2     public void update(float temp,float humidity,float pressure);
3 }
```



å¸ƒå‘Šæ¿æ˜¾ç¤ºæ¥å£ DisplayElement.java

```Java
1 public interface DisplayElement {
2     public void display();
3 }
```

WeatherDataå®ç°ä¸»é¢˜æ¥å£ WeatherData.java



```Java
 1 public class WeatherData implements Subject{
 2     private List<Observer> observers;
 3     private float tempterature;
 4     private float pressure;
 5     private float humidity;
 6
 7     public WeatherData(){
 8         observers = new ArrayList<Observer>();
 9     }
10
11     @Override
12     public void notifyObserver() {
13         for(int i = 0; i < observers.size();i++){
14             Observer observer = observers.get(i);
15             observer.update(tempterature, humidity, pressure);
16         }
17     }
18
19     @Override
20     public void registerObserver(Observer observer) {
21         observers.add(observer);
22     }
23
24     @Override
25     public void removeOberver(Observer observer) {
26         int i = observers.indexOf(observer);
27         if(i >= 0){
28             observers.remove(i);
29         }
30     }
31
32     /**
33      * æ°”è±¡ç«™å¾—åˆ°æ›´æ–°çš„è§‚æµ‹æ•°æ®æ—¶ï¼Œé€šçŸ¥è§‚å¯Ÿè€…
34      */
35     public void measurementChanged(){
36         notifyObserver();
37     }
38
39     public void setMeasurements(float temperature,float humidity,float pressure){
40         this.tempterature = temperature;
41         this.humidity = humidity;
42         this.pressure = pressure;
43         measurementChanged();
44     }
45 }
```



å¸ƒå‘Šæ¿  CurrentCondituonDisplay.java



```Java
 1 public class CurrentConditionsDisplay implements Observer,DisplayElement{
 2     private float temperature;
 3     private float humidity;
 4     private    Subject weatherData;
 5
 6     public CurrentConditionsDisplay(Subject weatherData){
 7         this.weatherData = weatherData;
 8         weatherData.registerObserver(this);      //æ³¨å†Œè§‚å¯Ÿè€…
 9     }
10
11     public void update(float temp, float humidity, float pressure) {
12         this.temperature = temp;
13         this.humidity = humidity;
14         display();
15     }
16
17     @Override
18     public void display() {
19         System.out.println("Current conditions:"+temperature+"F degrees and "+humidity+"% humidity");
20     }
21
22 }
```



æµ‹è¯•ç¨‹åº  WeatherStation



```Java
 1 public class WeatherStation {
 2
 3     public static void main(String[] args) {
 4         WeatherData weatherData = new WeatherData();
 5
 6         CurrentConditionsDisplay conditionsDisplay = new CurrentConditionsDisplay(weatherData);
 7
 8         weatherData.setMeasurements(80, 65, 30.4f);
 9         weatherData.setMeasurements(82, 70, 29.2f);
10         weatherData.setMeasurements(78, 78, 40.4f);
11     }
12 }
```



è¿è¡Œè¿‡ç¨‹

![img](http://static.iocoder.cn/csdn/20130521154221057)



# å››ã€è§‚å¯Ÿè€…æ¨¡å¼çš„ä¼˜ç¼ºç‚¹

## ä¼˜ç‚¹ï¼š

   1ã€å½“ä¸¤ä¸ªå¯¹è±¡ä¹‹é—´é€è€¦åˆï¼Œä»–ä»¬ä¾ç„¶å¯ä»¥äº¤äº’ï¼Œä½†æ˜¯ä¸å¤ªæ¸…æ¥šå½¼æ­¤çš„ç»†èŠ‚ã€‚è§‚å¯Ÿè€…æ¨¡å¼æä¾›äº†ä¸€ç§å¯¹è±¡è®¾è®¡ï¼Œè®©ä¸»é¢˜å’Œè§‚å¯Ÿè€…ä¹‹é—´é€è€¦åˆã€‚ä¸»é¢˜æ‰€çŸ¥é“åªæ˜¯ä¸€ä¸ªå…·ä½“çš„è§‚å¯Ÿè€…åˆ—è¡¨ï¼Œæ¯ä¸€ä¸ªå…·ä½“è§‚å¯Ÿè€…éƒ½ç¬¦åˆä¸€ä¸ªæŠ½è±¡è§‚å¯Ÿè€…çš„æ¥å£ã€‚ä¸»é¢˜å¹¶ä¸è®¤è¯†ä»»ä½•ä¸€ä¸ªå…·ä½“çš„è§‚å¯Ÿè€…ï¼Œå®ƒåªçŸ¥é“ä»–ä»¬éƒ½æœ‰ä¸€ä¸ªå…±åŒçš„æ¥å£ã€‚

   2ã€è§‚å¯Ÿè€…æ¨¡å¼æ”¯æŒâ€œå¹¿æ’­é€šä¿¡â€ã€‚ä¸»é¢˜ä¼šå‘æ‰€æœ‰çš„è§‚å¯Ÿè€…å‘å‡ºé€šçŸ¥ã€‚

   3ã€è§‚å¯Ÿè€…æ¨¡å¼ç¬¦åˆâ€œå¼€é—­åŸåˆ™â€çš„è¦æ±‚ã€‚

## ç¼ºç‚¹ï¼š

   1ã€å¦‚æœä¸€ä¸ªè¢«è§‚å¯Ÿè€…å¯¹è±¡æœ‰å¾ˆå¤šçš„ç›´æ¥å’Œé—´æ¥çš„è§‚å¯Ÿè€…çš„è¯ï¼Œå°†æ‰€æœ‰çš„è§‚å¯Ÿè€…éƒ½é€šçŸ¥åˆ°ä¼šèŠ±è´¹å¾ˆå¤šæ—¶é—´ã€‚

   2ã€ å¦‚æœåœ¨è§‚å¯Ÿè€…å’Œè§‚å¯Ÿç›®æ ‡ä¹‹é—´æœ‰å¾ªç¯ä¾èµ–çš„è¯ï¼Œè§‚å¯Ÿç›®æ ‡ä¼šè§¦å‘å®ƒä»¬ä¹‹é—´è¿›  è¡Œå¾ªç¯è°ƒç”¨ï¼Œå¯èƒ½å¯¼è‡´ç³»ç»Ÿå´©æºƒã€‚

   3ã€   è§‚å¯Ÿè€…æ¨¡å¼æ²¡æœ‰ç›¸åº”çš„æœºåˆ¶è®©è§‚å¯Ÿè€…çŸ¥é“æ‰€è§‚å¯Ÿçš„ç›®æ ‡å¯¹è±¡æ˜¯æ€ä¹ˆå‘ç”Ÿå˜åŒ–çš„ï¼Œè€Œä»…ä»…åªæ˜¯çŸ¥é“è§‚å¯Ÿç›®æ ‡å‘ç”Ÿäº†å˜åŒ–ã€‚



# äº”ã€è§‚å¯Ÿè€…æ¨¡å¼çš„é€‚ç”¨åœºæ‰€

â€‹       1ã€ä¸€ä¸ªæŠ½è±¡æ¨¡å‹æœ‰ä¸¤ä¸ªæ–¹é¢ï¼Œå…¶ä¸­ä¸€ä¸ªæ–¹é¢ä¾èµ–äºå¦ä¸€ä¸ªæ–¹é¢ã€‚å°†è¿™äº›æ–¹é¢å°è£…åœ¨ç‹¬ç«‹çš„å¯¹è±¡ä¸­ä½¿å®ƒä»¬å¯ä»¥å„è‡ªç‹¬ç«‹åœ°æ”¹å˜å’Œå¤ç”¨ã€‚

2ã€ä¸€ä¸ªå¯¹è±¡çš„æ”¹å˜å°†å¯¼è‡´å…¶ä»–ä¸€ä¸ªæˆ–å¤šä¸ªå¯¹è±¡ä¹Ÿå‘ç”Ÿæ”¹å˜ï¼Œè€Œä¸çŸ¥é“å…·ä½“æœ‰å¤šå°‘å¯¹è±¡å°†å‘ç”Ÿæ”¹å˜ï¼Œå¯ä»¥é™ä½å¯¹è±¡ä¹‹é—´çš„è€¦åˆåº¦ã€‚

3ã€ä¸€ä¸ªå¯¹è±¡å¿…é¡»é€šçŸ¥å…¶ä»–å¯¹è±¡ï¼Œè€Œå¹¶ä¸çŸ¥é“è¿™äº›å¯¹è±¡æ˜¯è°ã€‚éœ€è¦åœ¨ç³»ç»Ÿä¸­åˆ›å»ºä¸€ä¸ªè§¦å‘é“¾ï¼ŒAå¯¹è±¡çš„è¡Œä¸ºå°†å½±å“Bå¯¹è±¡ï¼ŒBå¯¹è±¡çš„è¡Œä¸ºå°†å½±å“Cå¯¹è±¡â€¦â€¦ï¼Œå¯ä»¥ä½¿ç”¨è§‚å¯Ÿè€…æ¨¡å¼åˆ›å»ºä¸€ç§é“¾å¼è§¦å‘æœºåˆ¶ã€‚



# æ€»ç»“

1ã€è§‚å¯Ÿè€…æ¨¡å¼å®šä¹‰äº†å¯¹è±¡ä¹‹é—´çš„ä¸€å¯¹å¤šå…³ç³»ã€‚å¤šä¸ªè§‚å¯Ÿè€…ç›‘å¬åŒä¸€ä¸ªè¢«è§‚å¯Ÿè€…ï¼Œå½“è¯¥è¢«è§‚å¯Ÿè€…çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œä¼šé€šçŸ¥æ‰€æœ‰çš„è§‚å¯Ÿè€…ã€‚

2ã€è§‚å¯Ÿè€…æ¨¡å¼ä¸­åŒ…å«å››ä¸ªè§’è‰²ã€‚ä¸»é¢˜ï¼Œå®ƒæŒ‡è¢«è§‚å¯Ÿçš„å¯¹è±¡ã€‚å…·ä½“ä¸»é¢˜æ˜¯ä¸»é¢˜å­ç±»ï¼Œé€šå¸¸å®ƒåŒ…å«æœ‰ç»å¸¸å‘ç”Ÿæ”¹å˜çš„æ•°æ®ï¼Œå½“å®ƒçš„çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œå‘å®ƒçš„å„ä¸ªè§‚å¯Ÿè€…å‘å‡ºé€šçŸ¥ï¼›è§‚å¯Ÿè€…ï¼Œå°†å¯¹è§‚å¯Ÿä¸»é¢˜çš„æ”¹å˜åšå‡ºååº”ï¼›å…·ä½“è§‚å¯Ÿè€…ä¸­ç»´æŠ¤ä¸€ä¸ªæŒ‡å‘å…·ä½“ç›®æ ‡å¯¹è±¡çš„å¼•ç”¨ï¼Œå®ƒå­˜å‚¨å…·ä½“è§‚å¯Ÿè€…çš„æœ‰å…³çŠ¶æ€ï¼Œè¿™äº›çŠ¶æ€éœ€è¦å’Œå…·ä½“ç›®æ ‡çš„çŠ¶æ€ä¿æŒä¸€è‡´ã€‚

3ã€ä¸»é¢˜ç”¨ä¸€ä¸ªå…±åŒçš„æ¥å£æ¥æ›´æ–°è§‚å¯Ÿè€…ã€‚

4ã€è§‚å¯Ÿè€…ä¸è¢«è§‚å¯Ÿè€…ä¹‹é—´ç”¨æ¾è€¦åˆæ–¹å¼ç»“åˆã€‚

5ã€æœ‰å¤šä¸ªè§‚å¯Ÿè€…æ—¶ï¼Œä¸å¯ä»¥ä¾èµ–ç‰¹å®šçš„é€šçŸ¥æ¬¡åºã€‚

6ã€ä½¿ç”¨è§‚å¯Ÿè€…æ¨¡å¼ï¼Œå¯ä»¥ä»è¢«è§‚å¯Ÿè€…å¤„æ¨æˆ–è€…æ‹‰æ•°æ®ã€‚



â€‹       è¯¥è¯»ä¹¦ç¬”è®°çš„ä»£ç å’Œéƒ¨åˆ†è¯­å¥å‡æ¥è‡ªã€ŠHead First è®¾è®¡æ¨¡å¼ã€‹

# 666. å½©è›‹

å¦‚æœä½ å¯¹ è®¾è®¡æ¨¡å¼ æ„Ÿå…´è¶£ï¼Œæ¬¢è¿åŠ å…¥æˆ‘çš„çŸ¥è¯†ä¸€èµ·äº¤æµã€‚

![çŸ¥è¯†æ˜Ÿçƒ](http://www.iocoder.cn/images/Architecture/2017_12_29/01.png)