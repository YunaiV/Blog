title: åˆ†å¸ƒå¼æ•°æ®åº“ä¸­é—´ä»¶è§£å†³æ–¹æ¡ˆ Sharding-Sphere 3.X
date: 2018-01-01
tags:
categories: Sharding Sphere
permalink: Sharding-Sphere/Distributed-database-middleware-solution-Sharding-Sphere-3.x
author: ShardingSphere
from_url: https://blog.csdn.net/ok449a6x1i6qq0g660fV/article/details/80491123

---

æ‘˜è¦: åŸåˆ›å‡ºå¤„ https://blog.csdn.net/ok449a6x1i6qq0g660fV/article/details/80491123 ã€ŒShardingSphereã€æ¬¢è¿è½¬è½½ï¼Œä¿ç•™æ‘˜è¦ï¼Œè°¢è°¢ï¼

-------

![](http://www.iocoder.cn/images/common/wechat_mp_2017_07_31.jpg)

> ğŸ™‚ğŸ™‚ğŸ™‚å…³æ³¨**å¾®ä¿¡å…¬ä¼—å·ï¼šã€èŠ‹é“æºç ã€‘**æœ‰ç¦åˆ©ï¼š
> 1. RocketMQ / MyCAT / Sharding-JDBC **æ‰€æœ‰**æºç åˆ†ææ–‡ç« åˆ—è¡¨
> 2. RocketMQ / MyCAT / Sharding-JDBC **ä¸­æ–‡æ³¨é‡Šæºç  GitHub åœ°å€**
> 3. æ‚¨å¯¹äºæºç çš„ç–‘é—®æ¯æ¡ç•™è¨€**éƒ½**å°†å¾—åˆ°**è®¤çœŸ**å›å¤ã€‚**ç”šè‡³ä¸çŸ¥é“å¦‚ä½•è¯»æºç ä¹Ÿå¯ä»¥è¯·æ•™å™¢**ã€‚
> 4. **æ–°çš„**æºç è§£ææ–‡ç« **å®æ—¶**æ”¶åˆ°é€šçŸ¥ã€‚**æ¯å‘¨æ›´æ–°ä¸€ç¯‡å·¦å³**ã€‚
> 5. **è®¤çœŸçš„**æºç äº¤æµå¾®ä¿¡ç¾¤ã€‚

-------

ç å†œå°‘é—²æœˆï¼Œäº”æœˆäººå€å¿™ï¼Sharding-Sphereåœ¨ç»å†å…¬æŠ•æ”¹åã€æ–°å®˜ç½‘ä¸Šçº¿ã€ç‰ˆæƒè½¬ç§»ç­‰ä¸€ç³»åˆ—é‡å¤§å˜é©åï¼Œç»ˆäºè¿æ¥äº†å®ƒçš„3.Xæ–°æ—¶ä»£ï¼ä»Sharding-JDBCåˆ°Sharding-Sphereï¼Œè€é“ç²‰é™ªå®ƒä¸€åŒèµ°è¿‡ï¼Œæ–°æœ‹å‹ä¹Ÿåœ¨é™†ç»­åŠ å…¥ã€‚Sharding-Sphereæ˜¯ä»€ä¹ˆï¼Ÿåšä»€ä¹ˆï¼Ÿåšçš„å¦‚ä½•ï¼Ÿä¸‰å¤§ç»å…¸æé—®å¸®åŠ©æ–°è€æœ‹å‹ä¸€åŒæ¸©æ•…çŸ¥æ–°ã€‚

**Sharding-Sphereæ˜¯ä»€ä¹ˆ?**

Sharding-Sphereæ˜¯ä¸€å¥—å¼€æºçš„åˆ†å¸ƒå¼æ•°æ®åº“ä¸­é—´ä»¶è§£å†³æ–¹æ¡ˆç»„æˆçš„ç”Ÿæ€åœˆï¼Œå®ƒç”±Sharding-JDBCã€Sharding-Proxyå’ŒSharding-Sidecarè¿™3æ¬¾ç›¸äº’ç‹¬ç«‹çš„äº§å“ç»„æˆã€‚ä»–ä»¬å‡æä¾›æ ‡å‡†åŒ–çš„æ•°æ®åˆ†ç‰‡ã€è¯»å†™åˆ†ç¦»ã€æŸ”æ€§äº‹åŠ¡å’Œæ•°æ®æ²»ç†åŠŸèƒ½ï¼Œå¯é€‚ç”¨äºå¦‚JavaåŒæ„ã€å¼‚æ„è¯­è¨€ã€å®¹å™¨ã€äº‘åŸç”Ÿç­‰å„ç§å¤šæ ·åŒ–çš„åº”ç”¨åœºæ™¯ã€‚

Sharding-Sphereå®šä½ä¸ºå…³ç³»å‹æ•°æ®åº“ä¸­é—´ä»¶ï¼Œæ—¨åœ¨å……åˆ†åˆç†åœ°åœ¨åˆ†å¸ƒå¼çš„åœºæ™¯ä¸‹åˆ©ç”¨å…³ç³»å‹æ•°æ®åº“çš„è®¡ç®—å’Œå­˜å‚¨èƒ½åŠ›ï¼Œè€Œå¹¶éå®ç°ä¸€ä¸ªå…¨æ–°çš„å…³ç³»å‹æ•°æ®åº“ã€‚å®ƒä¸NoSQLå’ŒNewSQLæ˜¯å¹¶å­˜è€Œéäº’æ–¥çš„å…³ç³»ã€‚NoSQLå’ŒNewSQLä½œä¸ºæ–°æŠ€æœ¯æ¢ç´¢çš„å‰æ²¿ï¼Œæ˜¯éå¸¸å€¼å¾—æ¨èçš„ã€‚è€ŒSharding-Sphereå…³æ³¨æœªæ¥ä¸å˜çš„ä¸œè¥¿ï¼Œè¿›è€ŒæŠ“ä½äº‹ç‰©æœ¬è´¨ã€‚å…³ç³»å‹æ•°æ®åº“å½“ä»Šä¾ç„¶å æœ‰å·¨å¤§å¸‚åœºï¼Œæ˜¯å„ä¸ªå…¬å¸æ ¸å¿ƒä¸šåŠ¡çš„åŸºçŸ³ï¼Œæˆ‘ä»¬ç›®å‰é˜¶æ®µæ›´åŠ å…³æ³¨åœ¨åŸæœ‰åŸºç¡€ä¸Šçš„å¢é‡ï¼Œè€Œéé¢ è¦†ã€‚å…¶æ¶æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![img](http://static.iocoder.cn/5abc5b9da4893739693e8cdca93b6e81)

**Sharding-Sphereå®¶æ—éƒ½æœ‰è°?**

Sharding-JDBC, Sharding-Proxyä»¥åŠSharding-Sidecar å…±åŒç»„æˆäº†Sharding-Sphereã€‚ä»–ä»¬åˆ†åˆ«å®šä½ã€é€‚ç”¨äºä¸åŒçš„åº”ç”¨åœºæ™¯ã€‚æ‚¨ä¹Ÿå¯ä»¥å°†ä»–ä»¬ç»„åˆä½¿ç”¨ä»¥å¾—åˆ°å¢ç›Šçš„æ€§èƒ½è¡¨ç°ã€‚

**1. Sharding-JDBC**

Sharding-JDBCæ˜¯Sharding-Sphereçš„ç¬¬ä¸€ä¸ªäº§å“ï¼Œä¹Ÿæ˜¯Sharding-Sphereçš„å‰èº«ã€‚ å®ƒå®šä½ä¸ºè½»é‡çº§Javaæ¡†æ¶ï¼Œåœ¨Javaçš„JDBCå±‚æä¾›åˆ†åº“åˆ†è¡¨ã€è¯»å†™åˆ†ç¦»ã€æ•°æ®åº“æ²»ç†ã€æŸ”æ€§äº‹åŠ¡ç­‰æœåŠ¡ã€‚å®ƒä½¿ç”¨å®¢æˆ·ç«¯ç›´è¿æ•°æ®åº“ï¼Œä»¥jaråŒ…å½¢å¼æä¾›æœåŠ¡ï¼Œæ— éœ€é¢å¤–éƒ¨ç½²å’Œä¾èµ–ï¼Œå¯ç†è§£ä¸ºå¢å¼ºç‰ˆçš„JDBCé©±åŠ¨ï¼Œå®Œå…¨å…¼å®¹JDBCå’Œå„ç§ORMæ¡†æ¶ã€‚

**2. Sharding-Proxy**

Sharding-Proxyæ˜¯Sharding-Sphereçš„ç¬¬äºŒä¸ªäº§å“ã€‚ å®ƒå®šä½ä¸ºé€æ˜åŒ–çš„æ•°æ®åº“ä»£ç†ç«¯ï¼Œæä¾›å°è£…äº†æ•°æ®åº“äºŒè¿›åˆ¶åè®®çš„æœåŠ¡ç«¯ç‰ˆæœ¬ï¼Œç”¨äºå®Œæˆå¯¹å¼‚æ„è¯­è¨€çš„æ”¯æŒã€‚ Sharding-Proxyå±è”½äº†åº•å±‚çš„åˆ†åº“åˆ†è¡¨ï¼Œæ‚¨å¯ä»¥åƒä½¿ç”¨ä¸€ä¸ªç®€å•çš„æ•°æ®åº“ä¸€æ ·æ¥æ“ä½œåˆ†åº“åˆ†è¡¨çš„æ•°æ®ã€‚ç›®å‰æä¾›MySQLç‰ˆæœ¬ï¼Œå®ƒå¯ä»¥ä½¿ç”¨ä»»ä½•å…¼å®¹MySQLåè®®çš„è®¿é—®å®¢æˆ·ç«¯(å¦‚ï¼šMySQL Command Client, MySQL Workbenchç­‰)æ¥è®¿é—®Sharding-Proxyï¼Œè¿›è€Œè¿›è¡ŒDDL/DMLç­‰æ“ä½œæ¥å˜æ›´æ•°æ®ï¼Œå¯¹DBAæ›´åŠ å‹å¥½ã€‚

**3. Mixed scheme of Sharding-JDBC & Sharding-Proxy**

ä¸ºäº†å¾—åˆ°æ›´å¥½çš„æ€§èƒ½ä»¥åŠå‹å¥½çš„äº¤äº’ä½“éªŒï¼Œæ‚¨å¯ä»¥åŒæ—¶ä½¿ç”¨Sharding-JDBCå’ŒSharding-Proxyã€‚

çº¿ä¸Šåº”ç”¨ä½¿ç”¨Sharding-JDBCç›´è¿æ•°æ®åº“ä»¥è·å–æœ€ä¼˜æ€§èƒ½ï¼Œä½¿ç”¨MySQLå‘½ä»¤è¡Œæˆ–UIå®¢æˆ·ç«¯è¿æ¥Sharding-Proxyæ–¹ä¾¿çš„æŸ¥è¯¢æ•°æ®å’Œæ‰§è¡Œå„ç§DDLè¯­å¥ã€‚å®ƒä»¬ä½¿ç”¨åŒä¸€ä¸ªæ³¨å†Œä¸­å¿ƒé›†ç¾¤ï¼Œé€šè¿‡ç®¡ç†ç«¯é…ç½®æ³¨å†Œä¸­å¿ƒä¸­çš„æ•°æ®ï¼Œå³å¯ç”±æ³¨å†Œä¸­å¿ƒè‡ªåŠ¨å°†é…ç½®å˜æ›´æ¨é€è‡³JDBCå’ŒProxyåº”ç”¨ã€‚è‹¥æ•°æ®åº“æ‹†åˆ†çš„è¿‡å¤šè€Œå¯¼è‡´è¿æ¥æ•°ä¼šæš´æ¶¨ï¼Œåˆ™å¯ä»¥è€ƒè™‘ç›´æ¥åœ¨çº¿ä¸Šä½¿ç”¨Sharding-Proxyï¼Œä»¥è¾¾åˆ°æœ‰æ•ˆæ§åˆ¶è¿æ¥æ•°çš„ç›®çš„ã€‚å…¶æ¶æ„å¦‚ä¸‹å¦‚æ‰€ç¤ºï¼š

![img](http://static.iocoder.cn/6402bfbd3b9de1603b74dbdb964c90bd)

**4. Sharding-Sidecar**

Sharding-Sidecaræ˜¯Sharding-Sphereçš„ç¬¬ä¸‰ä¸ªäº§å“ï¼Œç›®å‰ä»å¤„åœ¨å­µåŒ–ä¸­ã€‚ å®šä½ä¸ºKubernetesæˆ–Mesosçš„äº‘åŸç”Ÿæ•°æ®åº“ä»£ç†ã€‚å…¶æ ¸å¿ƒæ€æƒ³æ˜¯Database Meshï¼Œå³é€šè¿‡æ— ä¸­å¿ƒã€é›¶ä¾µå…¥çš„æ–¹æ¡ˆæä¾›ä¸æ•°æ®åº“äº¤äº’çš„å•®åˆå±‚ã€‚å…³æ³¨é‡ç‚¹åœ¨äºå¦‚ä½•å°†åˆ†å¸ƒå¼çš„æ•°æ®è®¿é—®åº”ç”¨ä¸æ•°æ®åº“æœ‰æœºä¸²è”èµ·æ¥ã€‚

 **Sharding-Sphereçš„åŠŸèƒ½ç‰¹æ€§**

**1. åˆ†åº“åˆ†è¡¨**

ä¸ºè§£å†³å…³ç³»å‹æ•°æ®åº“é¢å¯¹æµ·é‡æ•°æ®ç”±äºæ•°æ®é‡è¿‡å¤§è€Œå¯¼è‡´çš„æ€§èƒ½é—®é¢˜ï¼Œå°†æ•°æ®è¿›è¡Œåˆ†ç‰‡æ˜¯è¡Œä¹‹æœ‰æ•ˆçš„è§£å†³æ–¹æ¡ˆï¼Œè€Œå°†é›†ä¸­äºå•ä¸€èŠ‚ç‚¹çš„æ•°æ®æ‹†åˆ†å¹¶åˆ†åˆ«å­˜å‚¨åˆ°å¤šä¸ªæ•°æ®åº“æˆ–è¡¨ï¼Œç§°ä¸ºåˆ†åº“åˆ†è¡¨ã€‚ä½œä¸ºåˆ†å¸ƒå¼æ•°æ®åº“ä¸­é—´ä»¶ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯é€æ˜åŒ–åˆ†åº“åˆ†è¡¨æ‰€å¸¦æ¥çš„å½±å“ï¼Œè®©ä½¿ç”¨æ–¹å°½é‡åƒä½¿ç”¨ä¸€ä¸ªæ•°æ®åº“ä¸€æ ·ä½¿ç”¨æ°´å¹³æ‹†åˆ†ä¹‹åçš„æ•°æ®åº“ã€‚

**2. è¯»å†™åˆ†ç¦»**

é¢å¯¹æ—¥ç›Šå¢åŠ çš„ç³»ç»Ÿè®¿é—®é‡ï¼Œæ•°æ®åº“çš„ååé‡é¢ä¸´ç€å·¨å¤§ç“¶é¢ˆã€‚ å¯¹äºåŒä¸€æ—¶é—´æœ‰å¤§é‡å¹¶å‘è¯»æ“ä½œå’Œè¾ƒå°‘å†™æ“ä½œç±»å‹çš„åº”ç”¨ç³»ç»Ÿæ¥è¯´ï¼Œå°†å•ä¸€çš„æ•°æ®åº“æ‹†åˆ†ä¸ºä¸»åº“å’Œä»åº“ï¼Œä¸»åº“è´Ÿè´£å¤„ç†äº‹åŠ¡æ€§çš„å¢åˆ æ”¹æ“ä½œï¼Œä»åº“è´Ÿè´£å¤„ç†æŸ¥è¯¢æ“ä½œï¼Œèƒ½å¤Ÿæœ‰æ•ˆçš„é¿å…ç”±æ•°æ®æ›´æ–°å¯¼è‡´çš„è¡Œé”ï¼Œä½¿å¾—æ•´ä¸ªç³»ç»Ÿçš„æŸ¥è¯¢æ€§èƒ½å¾—åˆ°æå¤§çš„æ”¹å–„ã€‚é€æ˜åŒ–è¯»å†™åˆ†ç¦»æ‰€å¸¦æ¥çš„å½±å“ï¼Œè®©ä½¿ç”¨æ–¹å°½é‡åƒä½¿ç”¨ä¸€ä¸ªæ•°æ®åº“ä¸€æ ·ä½¿ç”¨ä¸»ä»æ•°æ®åº“ï¼Œæ˜¯è¯»å†™åˆ†ç¦»ä¸­é—´ä»¶çš„ä¸»è¦åŠŸèƒ½ã€‚

**3. æŸ”æ€§äº‹åŠ¡**

å¯¹äºåˆ†å¸ƒå¼çš„æ•°æ®åº“æ¥è¯´ï¼Œå¼ºä¸€è‡´æ€§åˆ†å¸ƒå¼äº‹åŠ¡åœ¨æ€§èƒ½æ–¹é¢å­˜åœ¨æ˜æ˜¾ä¸è¶³ã€‚è¿½æ±‚æœ€ç»ˆä¸€è‡´æ€§çš„æŸ”æ€§äº‹åŠ¡ï¼Œåœ¨æ€§èƒ½å’Œä¸€è‡´æ€§ä¸Šåˆ™æ˜¾å¾—æ›´åŠ å¹³è¡¡ã€‚ Sharding-Sphereç›®å‰æ”¯æŒæœ€å¤§åŠªåŠ›é€è¾¾å‹æŸ”æ€§äº‹åŠ¡ï¼Œæœªæ¥ä¹Ÿå°†æ”¯æŒTCCæŸ”æ€§äº‹åŠ¡ã€‚è‹¥ä¸ä½¿ç”¨æŸ”æ€§äº‹åŠ¡ï¼ŒSharding-Sphereä¹Ÿä¼šè‡ªåŠ¨åŒ…å«å¼±XAäº‹åŠ¡æ”¯æŒã€‚

**4. æ•°æ®æ²»ç†**

Sharding-Sphereæä¾›æ³¨å†Œä¸­å¿ƒã€é…ç½®åŠ¨æ€åŒ–ã€æ•°æ®åº“ç†”æ–­ç¦ç”¨ã€è°ƒç”¨é“¾è·¯ç­‰æ²»ç†èƒ½åŠ›ã€‚

**Sharding-Sphere 3.Xæ–°åŠŸèƒ½**

1. Sharding-Proxy MySQLç‰ˆæœ¬ä¸Šçº¿ï¼Œæ”¯æŒDML/DDL/DAL/DQLç­‰åŸºæœ¬ SQLã€‚å±è”½åº•å±‚æ‰€æœ‰åˆ†åº“åˆ†è¡¨ï¼Œå¯åƒä½¿ç”¨å•ä¸€MySQLæ•°æ®åº“ä¸€æ ·å¤„ç†åˆ†åº“åˆ†è¡¨æ•°æ®ã€‚
2. æ–°å¢å¯¹OR SQLè¯­å¥çš„æ”¯æŒï¼Œä¾‹å¦‚ï¼šselect * from t_order where (id>10 and id<20) or status=â€˜initâ€™;
3. æ–°å¢å¯¹INSERTæ‰¹é‡æ’å…¥çš„æ”¯æŒï¼Œä¾‹å¦‚ insert into t_order(order_id, user_id, status) values (1, 2, â€˜initâ€™), (2, 3, â€˜initâ€™), (3, 4, â€˜initâ€™);
4. ä¼˜åŒ–å¯¹INSERT SQLè¯­å¥çš„æ”¯æŒï¼Œä¸»è¦åŒ…æ‹¬ä¸æŒ‡å®šå…·ä½“åˆ—è¿›è¡ŒINSERTæ“ä½œï¼Œä¾‹å¦‚ï¼šinsert into t_order values(1, 2,â€˜initâ€™);
5. å¢åŠ è§£æå¼•æ“å¯¹SQLçš„ç¼“å­˜ï¼Œè¿›ä¸€æ­¥æå‡è§£ææ€§èƒ½ã€‚
6. Sharding-JDBCæ–°å¢å¯¹InlineExpressionå ä½ç¬¦$->{}çš„æ”¯æŒã€‚

æ–°çš„äº§å“ã€æ–°çš„ç‰¹æ€§ã€æ–°çš„ä¼˜åŒ–æ˜¯ä¸æ˜¯è®©ä½ çœ¼å‰ä¸€äº®ï¼Ÿé‚£å°±èµ¶å¿«æŠŠSharding-Sphere 3.Xç”¨èµ·æ¥å§ï¼

**æš–å¿ƒTipsï¼š**

â‘  ä½¿ç”¨Sharding-JDBCï¼Œå¯åŠ å…¥ä»¥ä¸‹Mavenä¾èµ–ï¼š

![img](http://static.iocoder.cn/5c97c09c0262336364827aa4b9ae573a)

â‘¡ ä½¿ç”¨Sharding-Proxyï¼Œå¯åœ¨è¿™é‡Œä¸‹è½½ï¼š

https://github.com/sharding-sphere/sharding-sphere-doc/raw/master/dist/sharding-proxy-3.0.0.M1.tar.gz

æ­¤å¤–ï¼Œæˆ‘ä»¬çš„DOCKERä¸‹è½½å‘½ä»¤å¦‚ä¸‹æ‰€ç¤ºï¼š

docker pull shardingsphere/sharding-proxy

**æ˜Ÿè·¯å†ç¨‹**

Sharding-Sphereè‡ª2016å¼€æºä»¥æ¥ï¼Œä¸æ–­ç²¾è¿›ã€ä¸æ–­å‘å±•ï¼Œè¢«è¶Šæ¥è¶Šå¤šçš„ä¼ä¸šå’Œä¸ªäººè®¤å¯ï¼šåœ¨Githubä¸Šæ”¶è·4000+çš„starï¼Œ1700+forksï¼Œ60+çš„å„å¤§å…¬å¸ä¼ä¸šä½¿ç”¨å®ƒï¼Œä¸ºSharding-Sphereæä¾›äº†é‡è¦çš„æˆåŠŸæ¡ˆä¾‹ã€‚æ­¤å¤–ï¼Œè¶Šæ¥è¶Šå¤šçš„ä¼ä¸šä¼™ä¼´å’Œä¸ªäººä¹ŸåŠ å…¥åˆ°Sharding-Sphereçš„å¼€æºé¡¹ç›®ä¸­ï¼Œä¸ºå®ƒçš„æˆé•¿å’Œå‘å±•è´¡çŒ®äº†å·¨å¤§åŠ›é‡ã€‚

æœªæ¥ï¼Œæˆ‘ä»¬å°†ä¸æ–­ä¼˜åŒ–å½“å‰çš„ç‰¹æ€§ï¼Œç²¾ç›Šæ±‚ç²¾ï¼›åŒæ—¶ï¼Œå¤§å®¶å…³æ³¨çš„æŸ”æ€§äº‹åŠ¡ã€æ•°æ®æ²»ç†ç­‰æ›´å¤šæ–°ç‰¹æ€§ä¹Ÿä¼šé™†ç»­ç™»åœºã€‚Sharding-Sidecarä¹Ÿå°†æˆä¸ºäº‘åŸç”Ÿçš„æ•°æ®åº“ä¸­é—´ä»¶ï¼

æ„¿æ‰€æœ‰æœ‰è¯†ä¹‹å£«èƒ½åŠ å…¥æˆ‘ä»¬ï¼Œä¸€åŒæç»˜Sharding-Sidecarçš„æ–°æœªæ¥ï¼

æ„¿æ­£åœ¨é˜…è¯»çš„ä½ ä¹Ÿèƒ½åŠ©æˆ‘ä»¬ä¸€è‡‚ä¹‹åŠ›ï¼Œè½¬è½½åˆ†äº«æ–‡ç« ã€åŠ å…¥å…³æ³¨æˆ‘ä»¬ï¼

**é¡¹ç›®åœ°å€**

https://github.com/sharding-sphere/sharding-sphere/

https://gitee.com/sharding-sphere/sharding-sphere/

æ›´å¤šä¿¡æ¯è¯·æµè§ˆå®˜ç½‘ï¼š

http://shardingsphere.io/