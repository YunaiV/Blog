title: æ·±å…¥ç†è§£Javaçš„ä¸‰ç§å·¥å‚æ¨¡å¼
date: 2019-02-16
tags:
categories: ç²¾è¿›
permalink: Fight/Deep-understanding-of-the-three-factory-patterns-of-Java
author: ç¼–è¾‘ä¹‹è·¯
from_url: https://my.oschina.net/u/4052893/blog/2995128
wechat_url:

-------

æ‘˜è¦: åŸåˆ›å‡ºå¤„ https://my.oschina.net/u/4052893/blog/2995128 ã€Œç¼–è¾‘ä¹‹è·¯ã€æ¬¢è¿è½¬è½½ï¼Œä¿ç•™æ‘˜è¦ï¼Œè°¢è°¢ï¼

- [ä¸€ã€ç®€å•å·¥å‚æ¨¡å¼](http://www.iocoder.cn/Fight/Deep-understanding-of-the-three-factory-patterns-of-Java/)
- [äºŒã€å·¥å‚æ–¹æ³•](http://www.iocoder.cn/Fight/Deep-understanding-of-the-three-factory-patterns-of-Java/)
- [ä¸‰ã€æŠ½è±¡å·¥å‚](http://www.iocoder.cn/Fight/Deep-understanding-of-the-three-factory-patterns-of-Java/)

-------

![](http://www.iocoder.cn/images/common/wechat_mp_2017_07_31.jpg)

> ğŸ™‚ğŸ™‚ğŸ™‚å…³æ³¨**å¾®ä¿¡å…¬ä¼—å·ï¼šã€èŠ‹é“æºç ã€‘**æœ‰ç¦åˆ©ï¼š
> 1. RocketMQ / MyCAT / Sharding-JDBC **æ‰€æœ‰**æºç åˆ†ææ–‡ç« åˆ—è¡¨
> 2. RocketMQ / MyCAT / Sharding-JDBC **ä¸­æ–‡æ³¨é‡Šæºç  GitHub åœ°å€**
> 3. æ‚¨å¯¹äºæºç çš„ç–‘é—®æ¯æ¡ç•™è¨€**éƒ½**å°†å¾—åˆ°**è®¤çœŸ**å›å¤ã€‚**ç”šè‡³ä¸çŸ¥é“å¦‚ä½•è¯»æºç ä¹Ÿå¯ä»¥è¯·æ•™å™¢**ã€‚
> 4. **æ–°çš„**æºç è§£ææ–‡ç« **å®æ—¶**æ”¶åˆ°é€šçŸ¥ã€‚**æ¯å‘¨æ›´æ–°ä¸€ç¯‡å·¦å³**ã€‚
> 5. **è®¤çœŸçš„**æºç äº¤æµå¾®ä¿¡ç¾¤ã€‚

-------

# ä¸€ã€ç®€å•å·¥å‚æ¨¡å¼

ç®€å•å·¥å‚çš„å®šä¹‰ï¼šæä¾›ä¸€ä¸ªåˆ›å»ºå¯¹è±¡å®ä¾‹çš„åŠŸèƒ½ï¼Œè€Œæ— é¡»å…³å¿ƒå…¶å…·ä½“å®ç°ã€‚è¢«åˆ›å»ºå®ä¾‹çš„ç±»å‹å¯ä»¥æ˜¯æ¥å£ã€æŠ½è±¡ç±»ï¼Œä¹Ÿå¯ä»¥æ˜¯å…·ä½“çš„ç±»

**å®ç°æ±½è½¦æ¥å£**

```Java
public interface Car {
    String getName();
}
```

**å¥”é©°ç±»**

```Java
public class Benz implements Car {
    @Override
    public String getName() {
        return "Benz";
    }
}
```

**å®é©¬ç±»**

```Java
public class BMW implements Car {
    @Override
    public String getName() {
        return "BMW";
    }
}
```

**ç®€å•å·¥å‚ï¼Œæ—¢èƒ½ç”Ÿäº§å®é©¬åˆèƒ½ç”Ÿäº§å¥”é©°**

```Java
public class SimpleFactory {
    public Car getCar(String name){
        if (name.equals("BMW")){
            return new BMW();
        }else if (name.equals("benz")){
            return new Benz();
        }else {
            System.out.println("ä¸å¥½æ„æ€ï¼Œè¿™ä¸ªå“ç‰Œçš„æ±½è½¦ç”Ÿäº§ä¸äº†");
            return null;
        }
    }
}
```

**æµ‹è¯•ç±»**

```Java
public class SimpleFactoryTest {
    public static void main(String[] args){
        SimpleFactory simpleFactory = new SimpleFactory();
        Car car = simpleFactory.getCar("BMW");
        System.out.println(car.getName());
    }
}
```

**æµ‹è¯•ç»“æœ**

```
BMW
```

æ ¹æ®ç®€å•å·¥å‚çš„å®šä¹‰ï¼Œç”¨æˆ·åªè¦äº§å“è€Œä¸åœ¨ä¹äº§å“å¦‚ä½•ç”Ÿäº§ï¼Œçœ‹èµ·æ¥å¥½åƒå¾ˆå®Œç¾çš„æ ·å­ã€‚ä½†å¤§å®¶æƒ³æƒ³ï¼Œè¿™ä¸ªä¸–ç•Œå­˜åœ¨ä»€ä¹ˆéƒ½ç”Ÿäº§çš„å·¥å‚å—ï¼Ÿ

æ˜¾ç„¶æ˜¯ä¸å­˜åœ¨çš„ï¼Œæ¯ä¸€ä¸ªæ±½è½¦å“ç‰Œéƒ½æœ‰è‡ªå·±çš„ç”Ÿäº§å·¥å‚ï¼Œéƒ½æœ‰è‡ªå·±ç”Ÿäº§æŠ€æœ¯ã€‚æ˜ å°„åˆ°springæ¡†æ¶ä¸­ï¼Œæˆ‘ä»¬æœ‰å¾ˆå¤šå¾ˆå¤šç§çš„beanéœ€è¦ç”Ÿäº§ï¼Œå¦‚æœåªä¾é ä¸€ä¸ªç®€å•å·¥å‚æ¥å®ç°ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¾—åœ¨å·¥å‚ç±»ä¸­åµŒå¥—å¤šå°‘ä¸ªif..else ifå•Šï¼Ÿ

è€Œä¸”æˆ‘ä»¬åœ¨ä»£ç ä¸­ç”Ÿäº§ä¸€è¾†æ±½è½¦åªæ˜¯newä¸€ä¸‹å°±å‡ºæ¥äº†ï¼Œä½†å®é™…æ“ä½œä¸­å´ä¸çŸ¥é“éœ€è¦è¿›è¡Œå¤šå°‘æ“ä½œï¼ŒåŠ è½½ã€æ³¨å†Œç­‰æ“ä½œéƒ½å°†ä½“ç°åœ¨å·¥å‚ç±»ä¸­ï¼Œé‚£ä¹ˆè¿™ä¸ªç±»å°±ä¼šå˜å¾—ç´Šä¹±ï¼Œç®¡ç†èµ·æ¥ä¹Ÿå¾ˆä¸æ–¹ä¾¿ï¼Œæ‰€ä»¥è¯´æ¯ä¸ªå“ç‰Œåº”è¯¥æœ‰è‡ªå·±çš„ç”Ÿäº§ç±»ã€‚

å› ä¸ºä¸“ä¸€ï¼Œæ‰€ä»¥ä¸“ä¸šå˜›ï¼Œè¿™ä¸ªæ—¶å€™å·¥å‚æ–¹æ³•å°±å‡ºç°äº†ã€‚

# äºŒã€å·¥å‚æ–¹æ³•

**å·¥å‚æ¥å£**

```Java
//å®šä¹‰ä¸€ä¸ªå·¥å‚æ¥å£ï¼ŒåŠŸèƒ½å°±æ˜¯ç”Ÿäº§æ±½è½¦
public interface Factory {
    Car getCar();
}
```

**å¥”é©°å·¥å‚**

```Java
public class BenzFactory implements Factory {
    @Override
    public Car getCar() {
        return new Benz();
    }
}
```

**å®é©¬å·¥å‚**

```Java
public class BMWFactory implements Factory{
    @Override
    public Car getCar() {
        return new BMW();
    }
}
```

**æµ‹è¯•ç±»**

```Java
public class FactoryTest {
   public static void main(String[] args){
       Factory bmwFactory = new BMWFactory();
       System.out.println(bmwFactory.getCar().getName());
       Factory benzFactory = new BenzFactory();
       System.out.println(benzFactory.getCar().getName());
   }
}
```

**æµ‹è¯•ç»“æœ**

```
BMW
Benz
```

æ ¹æ®ä¸Šè¿°ä»£ç å¯ä»¥çœ‹å‡ºï¼Œä¸åŒå“ç‰Œçš„æ±½è½¦æ˜¯ç”±ä¸åŒçš„å·¥å‚ç”Ÿäº§çš„ï¼Œè²Œä¼¼åˆæ˜¯å¾ˆå®Œç¾çš„ã€‚ä½†å¤§å®¶çœ‹ä¸€ä¸‹æµ‹è¯•ç±»ï¼Œå½“ä¸€ä¸ªäººæƒ³è¦å»ä¹°ä¸€è¾†å®é©¬æ±½è½¦çš„æ—¶å€™ï¼ˆå‡è®¾æ²¡æœ‰é”€å”®å•†ï¼‰ï¼Œé‚£ä¹ˆä»–å°±è¦å»æ‰¾å®é©¬å·¥å‚ç»™ä»–ç”Ÿäº§ä¸€è¾†ï¼Œè¿‡å‡ å¤©åˆæƒ³è¦ä¹°ä¸€è¾†å¥”é©°æ±½è½¦çš„æ—¶å€™ï¼Œåˆå¾—è·‘åˆ°å¥”é©°å·¥å‚è¯·äººç”Ÿäº§ï¼Œè¿™æ— ç–‘å°±å¢åŠ äº†ç”¨æˆ·çš„æ“ä½œå¤æ‚æ€§ã€‚æ‰€ä»¥æœ‰æ²¡æœ‰ä¸€ç§æ–¹ä¾¿ç”¨æˆ·æ“ä½œçš„æ–¹æ³•å‘¢ï¼Ÿè¿™ä¸ªæ—¶å€™æŠ½è±¡å·¥å‚æ¨¡å¼å°±å‡ºç°äº†ã€‚

# ä¸‰ã€æŠ½è±¡å·¥å‚

**æŠ½è±¡å·¥å‚**

```Java
public abstract class AbstractFactory {

     protected abstract Car getCar();

     //è¿™æ®µä»£ç å°±æ˜¯åŠ¨æ€é…ç½®çš„åŠŸèƒ½
     //å›ºå®šæ¨¡å¼çš„å§”æ´¾
     public Car getCar(String name){
        if("BMW".equalsIgnoreCase(name)){
            return new BmwFactory().getCar();
        }else if("Benz".equalsIgnoreCase(name)){
            return new BenzFactory().getCar();
        }else if("Audi".equalsIgnoreCase(name)){
            return new AudiFactory().getCar();
        }else{
            System.out.println("è¿™ä¸ªäº§å“äº§ä¸å‡ºæ¥");
            return null;
        }
    }
}
```

**é»˜è®¤å·¥å‚**

```Java
public class DefaultFactory extends AbstractFactory {

    private AudiFactory defaultFactory = new AudiFactory();

    public Car getCar() {
        return defaultFactory.getCar();
    }

}
```

**å®é©¬å·¥å‚**

```Java
public class BMWFactory extends AbstractFactory {
    @Override
    public Car getCar() {
        return new BMW();
    }
}
```

**å¥”é©°å·¥å‚**

```Java
public class BenzFactory extends AbstractFactory {
    @Override
    public Car getCar() {
        return new Benz();
    }
}
```

**æµ‹è¯•ç±»**

```Java
public class AbstractFactoryTest {
    public static void main(String[] args) {
        DefaultFactory factory = new DefaultFactory();
        System.out.println(factory.getCar("Benz").getName());
    }
}
```

**æµ‹è¯•ç»“æœ**

```
Benz
```

æ ¹æ®ä¸Šè¿°ä»£ç å¯ä»¥çœ‹å‡ºï¼Œç”¨æˆ·éœ€è¦ä¸€è¾†æ±½è½¦ï¼Œåªéœ€è¦å»æ‰¾é»˜è®¤çš„å·¥å‚æå‡ºè‡ªå·±çš„éœ€æ±‚ï¼ˆä¼ å…¥å‚æ•°ï¼‰ï¼Œä¾¿èƒ½å¾—åˆ°è‡ªå·±æƒ³è¦äº§å“ï¼Œè€Œä¸ç”¨æ ¹æ®äº§å“å»å¯»æ‰¾ä¸åŒçš„ç”Ÿäº§å·¥å‚ï¼Œæ–¹ä¾¿ç”¨æˆ·æ“ä½œã€‚

æ³¨ï¼šå¯¹äºè®¾è®¡æ¨¡å¼ï¼Œæœ‰äº›äººå—¤ä¹‹ä»¥é¼»ï¼Œæœ‰äº›äººæ•¬è‹¥ç¥æ˜ï¼Œä½†æˆ‘æ˜¯è®¤å¯çš„ã€‚

æŒ‰æˆ‘ç²—æµ…çš„ç†è§£ï¼Œè®¾è®¡æ¨¡å¼çš„ç»å…¸ä¹‹å¤„ï¼Œå°±åœ¨äºè§£å†³äº†ç¼–å†™ä»£ç çš„äººå’Œè°ƒç”¨ä»£ç çš„äººåŒæ–¹çš„ç—›æ¥šï¼Œä¸åŒçš„è®¾è®¡æ¨¡å¼ä¹Ÿåªé€‚ç”¨äºä¸åŒçš„åœºæ™¯ã€‚è‡³äºç”¨æˆ–è€…ä¸ç”¨ï¼Œå¦‚ä½•ä½¿ç”¨ï¼Œé‚£å°±éœ€è¦å„ä½çœ‹å®˜ç€é‡è€ƒè™‘äº†ã€‚

ä½†ä¸ºäº†ä½¿ç”¨è€Œä½¿ç”¨æ˜¯ä¸åº”è¯¥çš„ï¼Œç»†å¾®ä¹‹å¤„ï¼Œåªæœ‰ç•™ç»™å¤§å®¶æ…¢æ…¢å“å‘³äº†ã€‚