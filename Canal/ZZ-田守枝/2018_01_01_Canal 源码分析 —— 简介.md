title: Canal æºç åˆ†æ â€”â€” ç®€ä»‹
date: 2018-01-01
tag:
categories: Canal
permalink: Canal/tianshouzhi/tutorials
author: ç”°å®ˆæ
from_url: http://www.tianshouzhi.com/api/tutorials/canal
wechat_url:

-------

æ‘˜è¦: åŸåˆ›å‡ºå¤„ http://www.tianshouzhi.com/api/tutorials/canal ã€Œç”°å®ˆæã€æ¬¢è¿è½¬è½½ï¼Œä¿ç•™æ‘˜è¦ï¼Œè°¢è°¢ï¼

- [ä¸‹è½½é¡¹ç›®æºç ](http://www.iocoder.cn/Canal/tianshouzhi/tutorials/)
- [æºç æ¨¡å—åˆ’åˆ†](http://www.iocoder.cn/Canal/tianshouzhi/tutorials/)

-------

![](http://www.iocoder.cn/images/common/wechat_mp_2017_07_31.jpg)

> ğŸ™‚ğŸ™‚ğŸ™‚å…³æ³¨**å¾®ä¿¡å…¬ä¼—å·ï¼šã€èŠ‹é“æºç ã€‘**æœ‰ç¦åˆ©ï¼š
> 1. RocketMQ / MyCAT / Sharding-JDBC **æ‰€æœ‰**æºç åˆ†ææ–‡ç« åˆ—è¡¨
> 2. RocketMQ / MyCAT / Sharding-JDBC **ä¸­æ–‡æ³¨é‡Šæºç  GitHub åœ°å€**
> 3. æ‚¨å¯¹äºæºç çš„ç–‘é—®æ¯æ¡ç•™è¨€**éƒ½**å°†å¾—åˆ°**è®¤çœŸ**å›å¤ã€‚**ç”šè‡³ä¸çŸ¥é“å¦‚ä½•è¯»æºç ä¹Ÿå¯ä»¥è¯·æ•™å™¢**ã€‚
> 4. **æ–°çš„**æºç è§£ææ–‡ç« **å®æ—¶**æ”¶åˆ°é€šçŸ¥ã€‚**æ¯å‘¨æ›´æ–°ä¸€ç¯‡å·¦å³**ã€‚
> 5. **è®¤çœŸçš„**æºç äº¤æµå¾®ä¿¡ç¾¤ã€‚

-------

canalæ˜¯é˜¿é‡Œå·´å·´å¼€æºçš„mysqlæ•°æ®åº“binlogçš„å¢é‡è®¢é˜…&æ¶ˆè´¹ç»„ä»¶ã€‚é¡¹ç›®githubåœ°å€ä¸ºï¼š<https://github.com/alibaba/canal>ã€‚

æœ¬æ•™ç¨‹æ˜¯ä»æºç çš„è§’åº¦æ¥åˆ†æcanalï¼Œé€‚ç”¨äºå¯¹canalæœ‰ä¸€å®šåŸºç¡€çš„åŒå­¦ã€‚æœ¬æ•™ç¨‹ä½¿ç”¨çš„ç‰ˆæœ¬æ˜¯1.0.24ï¼Œè¿™ä¹Ÿæ˜¯ç¬”è€…å†™è¿™ç¯‡æ•™ç¨‹æ—¶çš„æœ€æ–°ç¨³å®šç‰ˆï¼Œå…³äºcanalçš„åŸºç¡€çŸ¥è¯†å¯ä»¥å‚è€ƒï¼š<https://github.com/alibaba/canal/wiki>ã€‚

# ä¸‹è½½é¡¹ç›®æºç 

ä¸‹è½½

```bash
git clone https://github.com/alibaba/canal.git
```

åˆ‡æ¢åˆ°canal-1.0.24è¿™ä¸ªtag

```bash
git checkout canal-1.0.24
```

# æºç æ¨¡å—åˆ’åˆ†

canalæ˜¯åŸºäºmavenæ„å»ºçš„ï¼Œæ€»å…±åˆ†æˆäº†14ä¸ªæ¨¡å—ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

![Image.png](http://static.tianshouzhi.com/ueditor/upload/image/20171206/1512568150870062324.png)

æ¨¡å—è™½å¤šï¼Œä½†æ˜¯æ¯ä¸ªæ¨¡å—çš„ä»£ç éƒ½å¾ˆå°‘ã€‚å„ä¸ªæ¨¡å—çš„ä½œç”¨å¦‚ä¸‹æ‰€ç¤ºï¼š

**commonæ¨¡å—ï¼š**ä¸»è¦æ˜¯æä¾›äº†ä¸€äº›å…¬å…±çš„å·¥å…·ç±»å’Œæ¥å£ã€‚

**clientæ¨¡å—ï¼š**canalçš„å®¢æˆ·ç«¯ã€‚æ ¸å¿ƒæ¥å£ä¸ºCanalConnector

**exampleæ¨¡å—ï¼š**æä¾›clientæ¨¡å—ä½¿ç”¨æ¡ˆä¾‹ã€‚

**protocolæ¨¡å—ï¼š**clientå’Œserveræ¨¡å—ä¹‹é—´çš„é€šä¿¡åè®®

**deployerï¼š**éƒ¨ç½²æ¨¡å—ã€‚é€šè¿‡è¯¥æ¨¡å—æä¾›çš„CanalLauncheræ¥å¯åŠ¨canal server

**serveræ¨¡å—ï¼š**canalæœåŠ¡å™¨ç«¯ã€‚æ ¸å¿ƒæ¥å£ä¸ºCanalServer

**instanceæ¨¡å—ï¼š**ä¸€ä¸ªserveræœ‰å¤šä¸ªinstanceã€‚æ¯ä¸ªinstanceéƒ½ä¼šæ¨¡æ‹Ÿæˆä¸€ä¸ªmysqlå®ä¾‹çš„slaveã€‚instanceæ¨¡å—æœ‰å››ä¸ªæ ¸å¿ƒç»„æˆéƒ¨åˆ†ï¼šparseræ¨¡å—ã€sinkæ¨¡å—ã€storeæ¨¡å—ï¼Œmetaæ¨¡å—ã€‚æ ¸å¿ƒæ¥å£ä¸ºCanalInstance

**parseræ¨¡å—ï¼š**æ•°æ®æºæ¥å…¥ï¼Œæ¨¡æ‹Ÿslaveåè®®å’Œmasterè¿›è¡Œäº¤äº’ï¼Œåè®®è§£æã€‚parseræ¨¡å—ä¾èµ–äºdbsyncã€driveræ¨¡å—ã€‚

**driveræ¨¡å—å’Œdbsyncæ¨¡å—ï¼š**ä»è¿™ä¸¤ä¸ªæ¨¡å—çš„artifactId(canal.parse.driverã€canal.parse.dbsync)ï¼Œå°±å¯ä»¥çœ‹å‡ºæ¥ï¼Œè¿™ä¸¤ä¸ªæ¨¡å—å®é™…ä¸Šæ˜¯parseræ¨¡å—çš„ç»„ä»¶ã€‚äº‹å®ä¸Šparser æ˜¯é€šè¿‡driveræ¨¡å—ä¸mysqlå»ºç«‹è¿æ¥ï¼Œä»è€Œè·å–åˆ°binlogã€‚ç”±äºåŸå§‹çš„binlogéƒ½æ˜¯äºŒè¿›åˆ¶æµï¼Œéœ€è¦è§£ææˆå¯¹åº”çš„binlogäº‹ä»¶ï¼Œè¿™äº›binlogäº‹ä»¶å¯¹è±¡éƒ½å®šä¹‰åœ¨dbsyncæ¨¡å—ä¸­ï¼Œdbsync æ¨¡å—æ¥è‡ªäºæ·˜å®çš„tddlã€‚

**sinkæ¨¡å—ï¼š**parserå’Œstoreé“¾æ¥å™¨ï¼Œè¿›è¡Œæ•°æ®è¿‡æ»¤ï¼ŒåŠ å·¥ï¼Œåˆ†å‘çš„å·¥ä½œã€‚æ ¸å¿ƒæ¥å£ä¸ºCanalEventSink

**storeæ¨¡å—ï¼š**æ•°æ®å­˜å‚¨ã€‚æ ¸å¿ƒæ¥å£ä¸ºCanalEventStore

**metaæ¨¡å—ï¼š**å¢é‡è®¢é˜…&æ¶ˆè´¹ä¿¡æ¯ç®¡ç†å™¨ï¼Œæ ¸å¿ƒæ¥å£ä¸ºCanalMetaManagerï¼Œä¸»è¦ç”¨äºè®°å½•canalæ¶ˆè´¹åˆ°çš„mysql binlogçš„ä½ç½®ï¼Œ



ä¸‹é¢å†é€šè¿‡ä¸€å¼ å›¾æ¥è¯´æ˜å„ä¸ªæ¨¡å—ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼š

![Image.png](http://static.tianshouzhi.com/ueditor/upload/image/20171206/1512568117592023226.png)

â€‹       é€šè¿‡deployeræ¨¡å—ï¼Œå¯åŠ¨ä¸€ä¸ªcanal-serverï¼Œä¸€ä¸ªcannal-serverå†…éƒ¨åŒ…å«å¤šä¸ªinstanceï¼Œæ¯ä¸ªinstanceéƒ½ä¼šä¼ªè£…æˆä¸€ä¸ªmysqlå®ä¾‹çš„slaveã€‚clientä¸serverä¹‹é—´çš„é€šä¿¡åè®®ç”±protocolæ¨¡å—å®šä¹‰ã€‚clientåœ¨è®¢é˜…binlogä¿¡æ¯æ—¶ï¼Œéœ€è¦ä¼ é€’ä¸€ä¸ªdestinationå‚æ•°ï¼Œserverä¼šæ ¹æ®è¿™ä¸ªdestinationç¡®å®šç”±å“ªä¸€ä¸ªinstanceä¸ºå…¶æä¾›æœåŠ¡ã€‚

åœ¨åˆ†ææºç çš„æ—¶å€™ï¼Œæœ¬äººä¹Ÿæ˜¯æŒ‰ç…§æ¨¡å—æ¥åˆ’åˆ†çš„ï¼ŒåŸºæœ¬ä¸Šä¸€ä¸ªæ¨¡å—å¯¹åº”ä¸€ç¯‡æ–‡ç« ã€‚