title: TiKV æºç è§£æ â€”â€” è°ƒè¯•ç¯å¢ƒæ­å»ºï¼ˆä¸€ï¼‰ä¹‹è¿è¡Œå•å…ƒæµ‹è¯•
date: 2019-08-01
tags:
categories:
permalink: TiKV/build-debugging-environment-first

-------

æ‘˜è¦: åŸåˆ›å‡ºå¤„ http://www.iocoder.cn/TiKV/build-debugging-environment-first/ ã€ŒèŠ‹é“æºç ã€æ¬¢è¿è½¬è½½ï¼Œä¿ç•™æ‘˜è¦ï¼Œè°¢è°¢ï¼

- [1. å®‰è£…ç¯å¢ƒ](http://www.iocoder.cn/TiKV/build-debugging-environment-first/)
  - [1.1 IntelliJ IDEA](http://www.iocoder.cn/TiKV/build-debugging-environment-first/)
  - [1.2 Rust](http://www.iocoder.cn/TiKV/build-debugging-environment-first/)
  - [1.3 Go](http://www.iocoder.cn/TiKV/build-debugging-environment-first/)
  - [1.4 RocksDB](http://www.iocoder.cn/TiKV/build-debugging-environment-first/)
  - [1.5 C++11](http://www.iocoder.cn/TiKV/build-debugging-environment-first/)
- [2. æºç å¯¼å…¥](http://www.iocoder.cn/TiKV/build-debugging-environment-first/)
- [3. è¿è¡Œå•å…ƒæµ‹è¯•](http://www.iocoder.cn/TiKV/build-debugging-environment-first/)
- [4. å½©è›‹](http://www.iocoder.cn/TiKV/build-debugging-environment-first/)

-------

![](http://www.iocoder.cn/images/common/wechat_mp_2018_05_18.jpg)

> ğŸ™‚ğŸ™‚ğŸ™‚å…³æ³¨**å¾®ä¿¡å…¬ä¼—å·ï¼šã€èŠ‹é“æºç ã€‘**æœ‰ç¦åˆ©ï¼š  
> 1. RocketMQ / MyCAT / Sharding-JDBC **æ‰€æœ‰**æºç åˆ†ææ–‡ç« åˆ—è¡¨  
> 2. RocketMQ / MyCAT / Sharding-JDBC **ä¸­æ–‡æ³¨é‡Šæºç  GitHub åœ°å€**  
> 3. æ‚¨å¯¹äºæºç çš„ç–‘é—®æ¯æ¡ç•™è¨€**éƒ½**å°†å¾—åˆ°**è®¤çœŸ**å›å¤ã€‚**ç”šè‡³ä¸çŸ¥é“å¦‚ä½•è¯»æºç ä¹Ÿå¯ä»¥è¯·æ•™å™¢**ã€‚  
> 4. **æ–°çš„**æºç è§£ææ–‡ç« **å®æ—¶**æ”¶åˆ°é€šçŸ¥ã€‚**æ¯å‘¨æ›´æ–°ä¸€ç¯‡å·¦å³**ã€‚  
> 5. **è®¤çœŸçš„**æºç äº¤æµå¾®ä¿¡ç¾¤ã€‚

---

TiKV è°ƒè¯•ç¯å¢ƒæ­å»ºï¼Œæˆ‘ä»¬æ ¹æ®ç›®çš„æ‹†åˆ†æˆä¸¤ç¯‡æ–‡ç«  ï¼š

* ç¬¬ä¸€ç¯‡ï¼Œ**æœ¬æ–‡**ï¼ŒæˆåŠŸè¿è¡Œ TiKV å•å…ƒæµ‹è¯•ã€‚
* ç¬¬äºŒç¯‡ï¼ŒæˆåŠŸè¿è¡Œ TiKV æœåŠ¡å®ä¾‹ã€‚

# 1. å®‰è£…ç¯å¢ƒ

ç³»ç»Ÿç‰ˆæœ¬ ï¼š`macOS Sierra 10.12.6`

## 1.1 IntelliJ IDEA

IntelliJ IDEA çš„å®‰è£…å¤§å®¶å·²ç»éå¸¸ç†Ÿæ‚‰äº†ï¼Œç¬”è€…å°±ä¸çæ¯”æ¯”äº†ã€‚

æ‰“å¼€ IDEA å®‰è£… Rust **æ’ä»¶** ï¼š

![](http://www.iocoder.cn/images/TiKV/2019_08_01/01.png)

## 1.2 Rust

```Bash
curl https://sh.rustup.rs -sSf | sh
```

* ç”±äº TiKV éœ€è¦ä½¿ç”¨ `nightly` ç‰ˆæœ¬ï¼Œå®‰è£…è¿‡ç¨‹å¦‚ä¸‹å›¾ ï¼š![](http://www.iocoder.cn/images/TiKV/2019_08_01/01.png/images/TiKV/2019_08_01/02.png)

Rust ç‰ˆæœ¬å¦‚ä¸‹ ï¼š

```Bash
Yunai-MacdeMacBook-Pro-2:~ yunai$ rustc --version
rustc 1.23.0-nightly (d6b06c63a 2017-11-09)
```

## 1.3 Go

**åŸºäº Homebrew**

```Bash
brew install go
```

Go ç‰ˆæœ¬å¦‚ä¸‹ ï¼š

```Bash
Yunai-MacdeMacBook-Pro-2:~ yunai$ go version
go version go1.9.2 darwin/amd64
```

## 1.4 RocksDB

**åŸºäº Homebrew**

æ‰“å¼€ç»ˆç«¯ï¼Œè¾“å…¥å‘½ä»¤ ï¼š

```Bash
brew install rocksdb
```

RocksDB ç‰ˆæœ¬å¦‚ä¸‹ ï¼š

```Bash
rocksdb 5.8 
```

## 1.5 C++11

**åŸºäº Homebrew**

ç¬”è€…æš‚ä¸ç¡®å®š**æ˜¯å¦å¿…é¡»å®‰è£…**ï¼Œå»ºè®®å¯ä»¥å…ˆå®‰è£…ã€‚

```Bash
brew install brew install boost --c++11
```

# 2. æºç å¯¼å…¥

ä»å®˜æ–¹ä»“åº“ [https://github.com/pingcap/tikv](https://github.com/pingcap/tikv) `Fork` å‡ºå±äºè‡ªå·±çš„ä»“åº“ã€‚ä¸ºä»€ä¹ˆè¦ `Fork` ï¼Ÿæ—¢ç„¶å¼€å§‹é˜…è¯»ã€è°ƒè¯•æºç ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šå†™ä¸€äº›æ³¨é‡Šï¼Œæœ‰äº†è‡ªå·±çš„ä»“åº“ï¼Œå¯ä»¥è¿›è¡Œè‡ªç”±çš„æäº¤ã€‚ğŸ˜ˆ

ä½¿ç”¨ IntelliJ IDEA ä» `Fork` å‡ºæ¥çš„ä»“åº“æ‹‰å–ä»£ç ï¼Œå¹¶å¯¼å…¥ã€‚å¯¼å…¥æ—¶ï¼Œè¯·è®°å¾—ä¸‹è½½ Standard library ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º ï¼š

![](http://www.iocoder.cn/images/TiKV/2019_08_01/03.png)

å¯¼å…¥å®Œæˆåï¼Œ[Cargo](http://wiki.jikexueyuan.com/project/rust/hello-cargo.html) ä¼š**è‡ªåŠ¨**ä¸‹è½½ TiKV é¡¹ç›®çš„ä¾èµ–åº“ï¼Œå¯èƒ½ä¸‹è½½æ—¶é—´è¾ƒé•¿ï¼Œè¯·è€å¿ƒç­‰å¾…ã€‚æ­¤æ—¶é€‚åˆï¼Œå…³æ³¨ä¸‹ç¬”è€…çš„å¾®ä¿¡å…¬ä¼—å·ï¼šã€**èŠ‹é“æºç **ã€‘ã€‚

# 3. è¿è¡Œå•å…ƒæµ‹è¯•

æ‰“å¼€ `tests/tests.rs` æ–‡ä»¶ï¼Œå³é”® `RUN '...'` è¿è¡Œ `#_0_ci_setup()` / `#_1_check_system_requirement()` å‡½æ•°ï¼Œè¿è¡Œé€šè¿‡ï¼Œè¯´æ˜è°ƒè¯•ç¯å¢ƒåŸºæœ¬æ­å»ºæˆåŠŸã€‚

æ­¤æ—¶ï¼Œå¦‚æœå‡ºç°å¦‚ä¸‹é”™è¯¯ ï¼š

```
error: `std::sync::atomic::AtomicUsize::new` is not yet stable as a const fn
  --> tests/coprocessor/test_select.rs:44:35
   |
44 | const ID_GENERATOR: AtomicUsize = AtomicUsize::new(1);
   |                                   ^^^^^^^^^^^^^^^^^^^
   |
   = help: in Nightly builds, add `#![feature(const_atomic_usize_new)]` to the crate attributes to enable

error: aborting due to previous error

error: Could not compile `tikv`.
warning: build failed, waiting for other jobs to finish...
error: build failed
```

* è¯·åœ¨ `tests/tests.rs` æ–‡ä»¶ï¼Œæ·»åŠ  `#[feature(const_atomic_usize_new)]` ä»£ç ã€‚å¦‚ä¸‹å›¾æ‰€ç¤º ï¼š![](http://www.iocoder.cn/images/TiKV/2019_08_01/04.png)

# 4. å½©è›‹

![çŸ¥è¯†æ˜Ÿçƒ](http://www.iocoder.cn/images/Architecture/2017_12_29/01.png)

T T è™½ç„¶æœ¬æ–‡éå¸¸ç®€çŸ­ï¼Œä½†æ˜¯æŠ˜è…¾äº†ä¸€å¤©å·¦å³ï¼Œè°è®©ç¬”è€…æ˜¯" **Rust èœé¸¡** "ã€‚

å¼€å§‹å°è¯•å†™ TiKV æºç è§£æç³»åˆ—ï¼Œæ•¬ç• + å¥½å¥‡ã€‚è™½ç„¶èµ¶è„šï¼Œå¯èƒ½ä¼šè¢«è™æˆä¸€æ¡ç‹—ã€‚

å¥½å•¦ï¼Œèƒ–å‹ï¼Œåˆ†äº«ä¸€æ³¢æœ‹å‹åœˆå¯å¥½ï¼


