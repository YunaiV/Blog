title: MyCAT æºç åˆ†æ â€”â€” ã€å•åº“å•è¡¨ã€‘æŸ¥è¯¢
date: 2017-05-30
tags:
categories: MyCAT
permalink: MyCAT/single-db-single-table-select

---

![](http://www.yunai.me/images/common/wechat_mp_2017_07_31.jpg)

> ğŸ™‚ğŸ™‚ğŸ™‚å…³æ³¨**å¾®ä¿¡å…¬ä¼—å·ï¼šã€èŠ‹è‰¿çš„åç«¯å°å±‹ã€‘**æœ‰ç¦åˆ©ï¼š  
> 1. RocketMQ / MyCAT / Sharding-JDBC **æ‰€æœ‰**æºç åˆ†ææ–‡ç« åˆ—è¡¨  
> 2. RocketMQ / MyCAT / Sharding-JDBC **ä¸­æ–‡æ³¨é‡Šæºç  GitHub åœ°å€**  
> 3. æ‚¨å¯¹äºæºç çš„ç–‘é—®æ¯æ¡ç•™è¨€**éƒ½**å°†å¾—åˆ°**è®¤çœŸ**å›å¤ã€‚**ç”šè‡³ä¸çŸ¥é“å¦‚ä½•è¯»æºç ä¹Ÿå¯ä»¥è¯·æ•™å™¢**ã€‚  
> 4. **æ–°çš„**æºç è§£ææ–‡ç« **å®æ—¶**æ”¶åˆ°é€šçŸ¥ã€‚**æ¯å‘¨æ›´æ–°ä¸€ç¯‡å·¦å³**ã€‚
> 5. **è®¤çœŸçš„**æºç äº¤æµå¾®ä¿¡ç¾¤ã€‚

-------

- [1. æ¦‚è¿°](#)
- [2. æ¥æ”¶è¯·æ±‚ï¼Œè§£æ SQL](#)
- [3. è·å¾—è·¯ç”±ç»“æœ](#)
- [4. è·å¾— MySQL è¿æ¥ï¼Œæ‰§è¡Œ SQL](#)
- [5. å“åº”æ‰§è¡Œ SQL ç»“æœ](#)
- [6. å…¶ä»– ï¼šæ›´æ–° / åˆ é™¤](#)

# 1. æ¦‚è¿°

> å†…å®¹å½¢æ€ä»¥ é¡ºåºå›¾ + æ ¸å¿ƒä»£ç  ä¸ºä¸»ã€‚  
> å¦‚æœæœ‰åœ°æ–¹è¡¨è¿°ä¸é”™è¯¯æˆ–è€…ä¸æ¸…æ™°ï¼Œæ¬¢è¿ç•™è¨€ã€‚  
> å¯¹äºå†…å®¹å½¢æ€ï¼Œéå¸¸çº ç»“ï¼Œå¦‚æœæœ‰å»ºè®®ï¼Œç‰¹åˆ«ç‰¹åˆ«ç‰¹åˆ«æ¬¢è¿æ‚¨æå‡ºã€‚  
> å¾®ä¿¡å·ï¼šwangwenbin-serverã€‚

æœ¬æ–‡è®²è§£ ã€å•åº“å•è¡¨ã€‘æŸ¥è¯¢ æ‰€æ¶‰åŠåˆ°çš„ä»£ç ã€‚
  
ğŸ˜‚å†…å®¹å’Œ [ã€ŠMyCAT æºç åˆ†æ â€”â€” ã€å•åº“å•è¡¨ã€‘æ’å…¥ã€‹](http://www.yunai.me/Mycat/single-db-single-table-insert/) è¶…çº§ç›¸ä¼¼ï¼Œä¸€æ–¹é¢æœ¬èº«æµç¨‹åŸºæœ¬ç›¸åŒï¼Œå¦å¤–ä¸€æ–¹é¢æ–‡ç« ç»“æ„æ²¡æ‹†åˆ†å¥½ã€‚æˆ‘ä»¬ä½¿ç”¨ ğŸš€ æ ‡è®°å·®å¼‚çš„é€»è¾‘ã€‚

äº¤äº’å¦‚ä¸‹å›¾ï¼š

![å•åº“å•è¡¨æŸ¥è¯¢ç®€å›¾](http://www.yunai.me/images/MyCAT/2017_05_30/01.png)

æ•´ä¸ªè¿‡ç¨‹ï¼ŒMyCAT Server æµç¨‹å¦‚ä¸‹ï¼š

1. æ¥æ”¶ MySQL Client è¯·æ±‚ï¼Œè§£æ SQLã€‚
2. è·å¾—è·¯ç”±ç»“æœï¼Œè¿›è¡Œè·¯ç”±ã€‚
3. è·å¾— MySQL è¿æ¥ï¼Œæ‰§è¡Œ SQLã€‚
4. å“åº”æ‰§è¡Œç»“æœï¼Œå‘é€ç»“æœç»™ MySQL Clientã€‚

æˆ‘ä»¬é€ä¸ªæ­¥éª¤åˆ†æï¼Œä¸€èµ·æ¥çœ‹çœ‹æºç ã€‚

# 2. æ¥æ”¶è¯·æ±‚ï¼Œè§£æ SQL

![ã€å•åº“å•è¡¨ã€‘æŸ¥è¯¢ï¼ˆ01ä¸»æµç¨‹ï¼‰](http://www.yunai.me/images/MyCAT/2017_05_30/02.png)

## ã€1 - 2ã€‘

æ¥æ”¶**ä¸€æ¡** MySQL å‘½ä»¤ã€‚åœ¨ã€1ã€‘ä¹‹å‰ï¼Œè¿˜æœ‰è¯·æ±‚æ•°æ®è¯»å–ã€æ‹†æˆå•æ¡ MySQL SQLã€‚

## ã€3ã€‘

```Java
  1: // â¬‡ï¸â¬‡ï¸â¬‡ï¸ã€FrontendCommandHandler.javaã€‘
  2: public class FrontendCommandHandler implements NIOHandler {
  3: 
  4:     @Override
  5:     public void handle(byte[] data) {
  6:     
  7:         // .... çœç•¥éƒ¨åˆ†ä»£ç 
  8:         switch (data[4]) // 
  9:         {
 10:             case MySQLPacket.COM_INIT_DB:
 11:                 commands.doInitDB();
 12:                 source.initDB(data);
 13:                 break;
 14:             case MySQLPacket.COM_QUERY: // æŸ¥è¯¢å‘½ä»¤
 15:                 // è®¡æ•°æŸ¥è¯¢å‘½ä»¤
 16:                 commands.doQuery();
 17:                 // æ‰§è¡ŒæŸ¥è¯¢å‘½ä»¤
 18:                 source.query(data);
 19:                 break;
 20:             case MySQLPacket.COM_PING:
 21:                 commands.doPing();
 22:                 source.ping();
 23:                 break;
 24:             // .... çœç•¥éƒ¨åˆ†case
 25:         }
 26:     }
 27: 
 28: }
```

`INSERT`/`SELECT`/`UPDATE`/`DELETE` ç­‰ SQL å½’å±äº `MySQLPacket.COM_QUERY`ï¼Œè¯¦ç»†å¯è§ï¼š[ã€ŠMySQLåè®®åˆ†æ#4.2 å®¢æˆ·ç«¯å‘½ä»¤è¯·æ±‚æŠ¥æ–‡ï¼ˆå®¢æˆ·ç«¯ -> æœåŠ¡å™¨ï¼‰ã€‹](http://hutaow.com/blog/2013/11/06/mysql-protocol-analysis/#42-)ã€‚

## ã€4ã€‘

å°† äºŒè¿›åˆ¶æ•°ç»„ è§£ææˆ SQLã€‚æ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š

```Java
  1: // â¬‡ï¸â¬‡ï¸â¬‡ï¸ã€FrontendConnection.javaã€‘
  2: public void query(byte[] data) {
  3: 	// å–å¾—è¯­å¥
  4: 	String sql = null;		
  5: 	try {
  6: 		MySQLMessage mm = new MySQLMessage(data);
  7: 		mm.position(5);
  8: 		sql = mm.readString(charset);
  9: 	} catch (UnsupportedEncodingException e) {
 10: 		writeErrMessage(ErrorCode.ER_UNKNOWN_CHARACTER_SET, "Unknown charset '" + charset + "'");
 11: 		return;
 12: 	}		
 13: 	// æ‰§è¡Œè¯­å¥
 14: 	this.query( sql );
 15: }
```

## ã€5ã€‘

è§£æ SQL ç±»å‹ã€‚æ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š

```Java
  1: // â¬‡ï¸â¬‡ï¸â¬‡ï¸ã€ServerQueryHandler.javaã€‘
  2: @Override
  3: public void query(String sql) {
  4: 	// è§£æ SQL ç±»å‹
  5: 	int rs = ServerParse.parse(sql);
  6: 	int sqlType = rs & 0xff;
  7: 	
  8: 	switch (sqlType) {
  9: 	//explain sql
 10: 	case ServerParse.EXPLAIN:
 11: 		ExplainHandler.handle(sql, c, rs >>> 8);
 12: 		break;
 13: 	// .... çœç•¥éƒ¨åˆ†case
 14: 		break;
 15: 	case ServerParse.SELECT:
 16: 		SelectHandler.handle(sql, c, rs >>> 8);
 17: 		break;
 18: 	// .... çœç•¥éƒ¨åˆ†case
 19: 	default:
 20: 		if(readOnly){
 21: 			LOGGER.warn(new StringBuilder().append("User readonly:").append(sql).toString());
 22: 			c.writeErrMessage(ErrorCode.ER_USER_READ_ONLY, "User readonly");
 23: 			break;
 24: 		}
 25: 		c.execute(sql, rs & 0xff);
 26: 	}
 27: }
 28: 
 29:
 30: // â¬‡ï¸â¬‡ï¸â¬‡ï¸ã€ServerParse.javaã€‘
 31: public static int parse(String stmt) {
 32: 	int length = stmt.length();
 33: 	//FIX BUG FOR SQL SUCH AS /XXXX/SQL
 34: 	int rt = -1;
 35: 	for (int i = 0; i < length; ++i) {
 36: 		switch (stmt.charAt(i)) {
 37: 		// .... çœç•¥éƒ¨åˆ†case			case 'I':
 38: 		case 'i':
 39: 			rt = insertCheck(stmt, i);
 40: 			if (rt != OTHER) {
 41: 				return rt;
 42: 			}
 43: 			continue;
 44: 			// .... çœç•¥éƒ¨åˆ†case
 45: 		case 'S':
 46: 		case 's':
 47: 			rt = sCheck(stmt, i);
 48: 			if (rt != OTHER) {
 49: 				return rt;
 50: 			}
 51: 			continue;
 52: 			// .... çœç•¥éƒ¨åˆ†case
 53: 		default:
 54: 			continue;
 55: 		}
 56: 	}
 57: 	return OTHER;
 58: }
```

## ğŸš€ã€6ã€‘ã€7ã€‘

è§£æ Select SQL ç±»å‹ï¼Œåˆ†å‘åˆ°å¯¹åº”çš„é€»è¾‘ã€‚æ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š

```Java
  1: // â¬‡ï¸â¬‡ï¸â¬‡ï¸ã€SelectHandler.javaã€‘
  2: public static void handle(String stmt, ServerConnection c, int offs) {
  3: 	int offset = offs;
  4: 	switch (ServerParseSelect.parse(stmt, offs)) { // è§£æ Select SQL ç±»å‹
  5: 	case ServerParseSelect.VERSION_COMMENT: // select @@VERSION_COMMENT;
  6: 		SelectVersionComment.response(c);
  7: 		break;
  8: 	case ServerParseSelect.DATABASE: // select DATABASE();
  9: 		SelectDatabase.response(c);
 10: 		break;
 11: 	case ServerParseSelect.USER: // select CURRENT_USER();
 12:         SelectUser.response(c);
 13: 		break;
 14: 	case ServerParseSelect.VERSION: // select VERSION();
 15: 		SelectVersion.response(c);
 16: 		break;
 17: 	case ServerParseSelect.SESSION_INCREMENT: // select @@session.auto_increment_increment;
 18: 		SessionIncrement.response(c);
 19: 		break;
 20: 	case ServerParseSelect.SESSION_ISOLATION: // select @@session.tx_isolation;
 21: 		SessionIsolation.response(c);
 22: 		break;
 23: 	case ServerParseSelect.LAST_INSERT_ID: // select LAST_INSERT_ID();
 24: 		// ....çœç•¥ä»£ç 
 25: 		break;
 26: 	case ServerParseSelect.IDENTITY: // select @@identity
 27: 		// ....çœç•¥ä»£ç 
 28: 		break;
 29:     case ServerParseSelect.SELECT_VAR_ALL: //
 30:         SelectVariables.execute(c,stmt);
 31:             break;
 32:     case ServerParseSelect.SESSION_TX_READ_ONLY: //
 33:         SelectTxReadOnly.response(c);
 34: 			break;
 35: 	default: // å…¶ä»–ï¼Œä¾‹å¦‚ select * from table
 36: 		c.execute(stmt, ServerParse.SELECT);
 37: 	}
 38: }
 39: // â¬‡ï¸â¬‡ï¸â¬‡ï¸ã€ServerParseSelect.javaã€‘
 40: public static int parse(String stmt, int offset) {
 41: 	int i = offset;
 42: 	for (; i < stmt.length(); ++i) {
 43: 		switch (stmt.charAt(i)) {
 44: 		case ' ':
 45: 			continue;
 46: 		case '/':
 47: 		case '#':
 48: 			i = ParseUtil.comment(stmt, i);
 49: 			continue;
 50: 		case '@':
 51: 			return select2Check(stmt, i);
 52: 		case 'D':
 53: 		case 'd':
 54: 			return databaseCheck(stmt, i);
 55: 		case 'L':
 56: 		case 'l':
 57: 			return lastInsertCheck(stmt, i);
 58: 		case 'U':
 59: 		case 'u':
 60: 			return userCheck(stmt, i);
 61: 		case 'C':
 62: 		case 'c':
 63: 			return currentUserCheck(stmt, i);
 64: 		case 'V':
 65: 		case 'v':
 66: 			return versionCheck(stmt, i);
 67: 		default:
 68: 			return OTHER;
 69: 		}
 70: 	}
 71: 	return OTHER;
 72: }
```

## ã€8ã€‘

æ‰§è¡Œ SQLï¼Œè¯¦ç»†è§£æè§ä¸‹æ–‡ï¼Œæ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š

```Java
  1: // â¬‡ï¸â¬‡ï¸â¬‡ï¸ã€ServerConnection.javaã€‘
  2: public class ServerConnection extends FrontendConnection {
  3: 	public void execute(String sql, int type) {
  4: 		// .... çœç•¥ä»£ç 
  5: 		SchemaConfig schema = MycatServer.getInstance().getConfig().getSchemas().get(db);
  6: 		if (schema == null) {
  7: 			writeErrMessage(ErrorCode.ERR_BAD_LOGICDB,
  8: 					"Unknown MyCAT Database '" + db + "'");
  9: 			return;
 10: 		}
 11: 
 12: 		// .... çœç•¥ä»£ç 
 13: 
 14: 		// è·¯ç”±åˆ°åç«¯æ•°æ®åº“ï¼Œæ‰§è¡Œ SQL
 15: 		routeEndExecuteSQL(sql, type, schema);
 16: 	}
 17: 	
 18:     public void routeEndExecuteSQL(String sql, final int type, final SchemaConfig schema) {
 19: 		// è·¯ç”±è®¡ç®—
 20: 		RouteResultset rrs = null;
 21: 		try {
 22: 			rrs = MycatServer
 23: 					.getInstance()
 24: 					.getRouterservice()
 25: 					.route(MycatServer.getInstance().getConfig().getSystem(),
 26: 							schema, type, sql, this.charset, this);
 27: 
 28: 		} catch (Exception e) {
 29: 			StringBuilder s = new StringBuilder();
 30: 			LOGGER.warn(s.append(this).append(sql).toString() + " err:" + e.toString(),e);
 31: 			String msg = e.getMessage();
 32: 			writeErrMessage(ErrorCode.ER_PARSE_ERROR, msg == null ? e.getClass().getSimpleName() : msg);
 33: 			return;
 34: 		}
 35: 
 36: 		// æ‰§è¡Œ SQL
 37: 		if (rrs != null) {
 38: 			// sessionæ‰§è¡Œ
 39: 			session.execute(rrs, rrs.isSelectForUpdate() ? ServerParse.UPDATE : type);
 40: 		}
 41: 		
 42:  	}
 43: 
 44: }
```

# 3. è·å¾—è·¯ç”±ç»“æœ

![ã€å•åº“å•è¡¨ã€‘æ’å…¥ï¼ˆ02è·å–è·¯ç”±ï¼‰](http://www.yunai.me/images/MyCAT/2017_05_30/03.png)

## ã€ 1 -  5 ã€‘

è·å¾—è·¯ç”±ä¸»æµç¨‹ã€‚æ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š

```Java
  1: // â¬‡ï¸â¬‡ï¸â¬‡ï¸ã€SelectHandler.javaã€‘
  2: public RouteResultset route(SystemConfig sysconf, SchemaConfig schema,
  3: 		int sqlType, String stmt, String charset, ServerConnection sc)
  4: 		throws SQLNonTransientException {
  5: 	RouteResultset rrs = null;
  6: 
  7: 	// SELECT ç±»å‹çš„SQL, æ£€æµ‹ç¼“å­˜æ˜¯å¦å­˜åœ¨
  8: 	if (sqlType == ServerParse.SELECT) {
  9: 		cacheKey = schema.getName() + stmt;			
 10: 		rrs = (RouteResultset) sqlRouteCache.get(cacheKey);
 11: 		if (rrs != null) {
 12: 			checkMigrateRule(schema.getName(),rrs,sqlType);
 13: 			return rrs;
 14: 			}
 15: 		}
 16: 	}
 17: 
 18: 	// .... çœç•¥ä»£ç 
 19: 	int hintLength = RouteService.isHintSql(stmt);
 20: 	if(hintLength != -1){ // TODO å¾…è¯»ï¼šhint
 21: 		// .... çœç•¥ä»£ç 
 22: 		}
 23: 	} else {
 24: 		stmt = stmt.trim();
 25: 		rrs = RouteStrategyFactory.getRouteStrategy().route(sysconf, schema, sqlType, stmt,
 26: 				charset, sc, tableId2DataNodeCache);
 27: 	}
 28: 
 29: 	// è®°å½•æŸ¥è¯¢å‘½ä»¤è·¯ç”±ç»“æœç¼“å­˜
 30: 	if (rrs != null && sqlType == ServerParse.SELECT && rrs.isCacheAble()) {
 31: 		sqlRouteCache.putIfAbsent(cacheKey, rrs);
 32: 	}
 33: 	// .... çœç•¥ä»£ç 		return rrs;
 34: }
 35: // â¬‡ï¸â¬‡ï¸â¬‡ï¸ã€AbstractRouteStrategy.javaã€‘
 36: @Override
 37: public RouteResultset route(SystemConfig sysConfig, SchemaConfig schema, int sqlType, String origSQL,
 38: 		String charset, ServerConnection sc, LayerCachePool cachePool) throws SQLNonTransientException {
 39: 
 40: 	// .... çœç•¥ä»£ç 
 41: 
 42: 	// å¤„ç†ä¸€äº›è·¯ç”±ä¹‹å‰çš„é€»è¾‘;å…¨å±€åºåˆ—å·ï¼Œçˆ¶å­è¡¨æ’å…¥
 43: 	if (beforeRouteProcess(schema, sqlType, origSQL, sc) ) {
 44: 		return null;
 45: 	}
 46: 
 47: 	// .... çœç•¥ä»£ç 
 48: 
 49: 	// æ£€æŸ¥æ˜¯å¦æœ‰åˆ†ç‰‡
 50: 	if (schema.isNoSharding() && ServerParse.SHOW != sqlType) {
 51: 		rrs = RouterUtil.routeToSingleNode(rrs, schema.getDataNode(), stmt);
 52: 	} else {
 53: 		RouteResultset returnedSet = routeSystemInfo(schema, sqlType, stmt, rrs);
 54: 		if (returnedSet == null) {
 55: 			rrs = routeNormalSqlWithAST(schema, stmt, rrs, charset, cachePool,sqlType,sc);
 56: 		}
 57: 	}
 58: 
 59: 	return rrs;
 60: }
```

ğŸš€ã€3ã€‘ç¬¬ 7 è‡³ 16 è¡Œ ï¼šå½“ Select SQL å­˜åœ¨è·¯ç”±ç»“æœç¼“å­˜æ—¶ï¼Œç›´æ¥è¿”å›ç¼“å­˜ã€‚
ğŸš€ã€6ã€‘ç¬¬ 29 è‡³ 32 è¡Œ ï¼šè®°å½• Select SQL è·¯ç”±ç»“æœåˆ°ç¼“å­˜ã€‚

_**è·¯ç”±** è¯¦ç»†è§£æï¼Œæˆ‘ä»¬å¦å¼€æ–‡ç« ï¼Œé¿å…å†…å®¹è¿‡å¤šï¼Œå½±å“å¤§å®¶å¯¹ã€æ’å…¥ã€‘æµç¨‹å’Œé€»è¾‘çš„ç†è§£ã€‚_

# 4. è·å¾— MySQL è¿æ¥ï¼Œæ‰§è¡Œ SQL

![ã€å•åº“å•è¡¨ã€‘æŸ¥è¯¢ï¼ˆ03æ‰§è¡Œ SQLï¼‰](http://www.yunai.me/images/MyCAT/2017_05_29/03.png)

## ã€ 1 - 8 ã€‘

è·å¾— MySQL è¿æ¥ã€‚

* PhysicalDBNode ï¼šç‰©ç†æ•°æ®åº“èŠ‚ç‚¹ã€‚
* PhysicalDatasource ï¼šç‰©ç†æ•°æ®åº“æ•°æ®æºã€‚

## ã€ 9 - 13 ã€‘

å‘é€ SQL åˆ° MySQL Serverï¼Œæ‰§è¡Œ SQLã€‚

# ğŸš€ 5. å“åº”æ‰§è¡Œ SQL ç»“æœ

![ã€å•åº“å•è¡¨ã€‘æŸ¥è¯¢ï¼ˆ04æ‰§è¡Œå“åº”ï¼‰](http://www.yunai.me/images/MyCAT/2017_05_30/04.png)

æ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š

```Java
  1: // â¬‡ï¸â¬‡ï¸â¬‡ï¸ã€MySQLConnectionHandler.javaã€‘
  2: @Override
  3: protected void handleData(byte[] data) {
  4: 	switch (resultStatus) {
  5: 	case RESULT_STATUS_INIT:
  6: 		switch (data[4]) {
  7: 		case OkPacket.FIELD_COUNT:
  8: 			handleOkPacket(data);
  9: 			break;
 10: 		case ErrorPacket.FIELD_COUNT:
 11: 			handleErrorPacket(data);
 12: 			break;
 13: 		case RequestFilePacket.FIELD_COUNT:
 14: 			handleRequestPacket(data);
 15: 			break;
 16: 		default: // åˆå§‹åŒ– header fields
 17: 			resultStatus = RESULT_STATUS_HEADER;
 18: 			header = data;
 19: 			fields = new ArrayList<byte[]>((int) ByteUtil.readLength(data,
 20: 					4));
 21: 		}
 22: 		break;
 23: 	case RESULT_STATUS_HEADER:
 24: 		switch (data[4]) {
 25: 		case ErrorPacket.FIELD_COUNT:
 26: 			resultStatus = RESULT_STATUS_INIT;
 27: 			handleErrorPacket(data);
 28: 			break;
 29: 		case EOFPacket.FIELD_COUNT: // è§£æ fields ç»“æŸ
 30: 			resultStatus = RESULT_STATUS_FIELD_EOF;
 31: 			handleFieldEofPacket(data);
 32: 			break;
 33: 		default: // è§£æ fields
 34: 			fields.add(data);
 35: 		}
 36: 		break;
 37: 	case RESULT_STATUS_FIELD_EOF:
 38: 		switch (data[4]) {
 39: 		case ErrorPacket.FIELD_COUNT:
 40: 			resultStatus = RESULT_STATUS_INIT;
 41: 			handleErrorPacket(data);
 42: 			break;
 43: 		case EOFPacket.FIELD_COUNT: // è§£æ æ¯è¡Œè®°å½• ç»“æŸ
 44: 			resultStatus = RESULT_STATUS_INIT;
 45: 			handleRowEofPacket(data);
 46: 			break;
 47: 		default: // æ¯è¡Œè®°å½•
 48: 			handleRowPacket(data);
 49: 		}
 50: 		break;
 51: 	default:
 52: 		throw new RuntimeException("unknown status!");
 53: 	}
 54: }
```

# 6. å…¶ä»– ï¼šæ›´æ–° / åˆ é™¤

æµç¨‹åŸºæœ¬å’Œ [ã€ŠMyCATæºç åˆ†æï¼šã€å•åº“å•è¡¨ã€‘æ’å…¥ã€‹](http://www.yunai.me/Mycat/single-db-single-table-insert/) ç›¸åŒã€‚æˆ‘ä»¬å°±ä¸å¦å¤–æ–‡ç« è§£æã€‚


